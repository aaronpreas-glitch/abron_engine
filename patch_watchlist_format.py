#!/usr/bin/env python3
import base64, ast, sys

FORMAT_B64 = """ZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGh0bWwKCgpkZWYgX2VzYyh2YWx1ZSk6CiAgICByZXR1cm4gaHRtbC5lc2NhcGUoc3RyKHZhbHVlKSkKCgpkZWYgX3JlbmRlcl9wcmUocm93cyk6CiAgICBsaW5lcyA9IFtzdHIocm93IG9yICIiKSBmb3Igcm93IGluIHJvd3NdCiAgICBpZiBub3QgbGluZXM6CiAgICAgICAgcmV0dXJuICIiCiAgICBwYW5lbF93aWR0aCA9IF9QQU5FTF9XSURUSAogICAgd3JhcHBlZCA9IFtdCiAgICBmb3IgbGluZSBpbiBsaW5lczoKICAgICAgICB3cmFwcGVkLmV4dGVuZChfd3JhcF90ZXh0KGxpbmUsIHBhbmVsX3dpZHRoKSkKICAgIHJldHVybiAiXG4iLmpvaW4oZiI8Y29kZT57X2VzYyhsaW5lKX08L2NvZGU+IiBmb3IgbGluZSBpbiB3cmFwcGVkKQoKCl9QQU5FTF9XSURUSCA9IDQyCgoKZGVmIF90cmltX3RleHQodmFsdWUsIG1heF9sZW4pOgogICAgdGV4dCA9IHN0cih2YWx1ZSBvciAiIikKICAgIGlmIG1heF9sZW4gPD0gMDoKICAgICAgICByZXR1cm4gdGV4dAogICAgcmV0dXJuIHRleHQKCgpkZWYgX3dyYXBfdGV4dCh2YWx1ZSwgbWF4X2xlbik6CiAgICB0ZXh0ID0gc3RyKHZhbHVlIG9yICIiKQogICAgaWYgbWF4X2xlbiA8PSAwIG9yIGxlbih0ZXh0KSA8PSBtYXhfbGVuOgogICAgICAgIHJldHVybiBbdGV4dF0KICAgIG91dCA9IFtdCiAgICByZW1haW5pbmcgPSB0ZXh0CiAgICB3aGlsZSBsZW4ocmVtYWluaW5nKSA+IG1heF9sZW46CiAgICAgICAgY3V0ID0gcmVtYWluaW5nLnJmaW5kKCIgIiwgMCwgbWF4X2xlbiArIDEpCiAgICAgICAgaWYgY3V0IDw9IDA6CiAgICAgICAgICAgIGN1dCA9IG1heF9sZW4KICAgICAgICBvdXQuYXBwZW5kKHJlbWFpbmluZ1s6Y3V0XS5yc3RyaXAoKSkKICAgICAgICByZW1haW5pbmcgPSByZW1haW5pbmdbY3V0Ol0ubHN0cmlwKCkKICAgIG91dC5hcHBlbmQocmVtYWluaW5nKQogICAgcmV0dXJuIG91dAoKCmRlZiBfa3YobGFiZWwsIHZhbHVlLCB3aWR0aDogaW50ID0gX1BBTkVMX1dJRFRIKToKICAgIGtleSA9IHN0cihsYWJlbCBvciAiIikudXBwZXIoKVs6OV0KICAgIGxpbmUgPSBmIntrZXk6PDl9IHwge3ZhbHVlfSIKICAgIHJldHVybiBfdHJpbV90ZXh0KGxpbmUsIHdpZHRoKQoKCmRlZiBfaGVhZGVyX2Jsb2NrKHRhZzogc3RyLCBoZWFkZXJfcm93cz1Ob25lLCB3aWR0aDogaW50ID0gX1BBTkVMX1dJRFRIKToKICAgIHJvd3MgPSBbCiAgICAgICAgZiI8Yj57X2VzYyh0YWcpfTwvYj4iLAogICAgICAgIGYiPGNvZGU+eyctJyAqIG1pbigzMCwgd2lkdGgpfTwvY29kZT4iLAogICAgXQogICAgZm9yIHJvdyBpbiAoaGVhZGVyX3Jvd3Mgb3IgW10pOgogICAgICAgIHJvd3MuYXBwZW5kKGYiPGNvZGU+e19lc2MoX3RyaW1fdGV4dChzdHIocm93IG9yICcnKSwgd2lkdGgpKX08L2NvZGU+IikKICAgIHJldHVybiAiXG4iLmpvaW4ocm93cykKCgpkZWYgX3Njb3JlX2JhcihzY29yZSk6CiAgICBzY29yZSA9IG1heCgwLCBtaW4oMTAwLCBmbG9hdChzY29yZSBvciAwKSkpCiAgICBibG9ja3MgPSBpbnQocm91bmQoc2NvcmUgLyAxMC4wKSkKICAgIHJldHVybiAoIiMiICogYmxvY2tzKSArICgiLSIgKiAoMTAgLSBibG9ja3MpKQoKCmRlZiBfZm10X3BjdCh2YWx1ZSk6CiAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgIHJldHVybiAiTi9BIgogICAgdHJ5OgogICAgICAgIG51bWJlciA9IGZsb2F0KHZhbHVlKQogICAgICAgIHNpZ24gPSAiKyIgaWYgbnVtYmVyID4gMCBlbHNlICIiCiAgICAgICAgcmV0dXJuIGYie3NpZ259e251bWJlcjouMmZ9JSIKICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICByZXR1cm4gIk4vQSIKCgpkZWYgX2ZtdF9udW0odmFsdWUsIGRpZ2l0cz0wKToKICAgIHRyeToKICAgICAgICByZXR1cm4gZiJ7ZmxvYXQodmFsdWUpOiwue2RpZ2l0c31mfSIKICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICByZXR1cm4gIk4vQSIKCgpkZWYgX2ZtdF91c2RfY29tcGFjdCh2YWx1ZSk6CiAgICB0cnk6CiAgICAgICAgbiA9IGZsb2F0KHZhbHVlKQogICAgZXhjZXB0IChUeXBlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHJldHVybiAiTi9BIgogICAgYWJzX24gPSBhYnMobikKICAgIGlmIGFic19uID49IDFfMDAwXzAwMF8wMDA6CiAgICAgICAgcmV0dXJuIGYiJHtuLzFfMDAwXzAwMF8wMDA6LjJmfUIiCiAgICBpZiBhYnNfbiA+PSAxXzAwMF8wMDA6CiAgICAgICAgcmV0dXJuIGYiJHtuLzFfMDAwXzAwMDouMmZ9TSIKICAgIGlmIGFic19uID49IDFfMDAwOgogICAgICAgIHJldHVybiBmIiR7bi8xXzAwMDouMWZ9SyIKICAgIHJldHVybiBmIiR7bjouMGZ9IgoKCmRlZiBfZm10X3ByaWNlX3ByZWNpc2UodmFsdWUpOgogICAgdHJ5OgogICAgICAgIHAgPSBmbG9hdCh2YWx1ZSkKICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICByZXR1cm4gIk4vQSIKICAgIGlmIHAgPD0gMDoKICAgICAgICByZXR1cm4gIk4vQSIKICAgIGlmIHAgPCAwLjAxOgogICAgICAgIHJldHVybiBmIiR7cDouOGZ9Ii5yc3RyaXAoIjAiKS5yc3RyaXAoIi4iKQogICAgaWYgcCA8IDE6CiAgICAgICAgcmV0dXJuIGYiJHtwOi42Zn0iLnJzdHJpcCgiMCIpLnJzdHJpcCgiLiIpCiAgICBpZiBwIDwgMTAwMDoKICAgICAgICByZXR1cm4gZiIke3A6LjRmfSIucnN0cmlwKCIwIikucnN0cmlwKCIuIikKICAgIHJldHVybiBfZm10X3VzZF9jb21wYWN0KHApCgoKZGVmIF9mbXRfaG9sZGVycyh2YWx1ZSk6CiAgICBpZiB2YWx1ZSBpbiAoTm9uZSwgIiIsICJOL0EiKToKICAgICAgICByZXR1cm4gIk4vQSIKICAgIHRyeToKICAgICAgICByZXR1cm4gZiJ7aW50KGZsb2F0KHZhbHVlKSk6LH0iCiAgICBleGNlcHQgKFR5cGVFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgcmV0dXJuICJOL0EiCgoKZGVmIF9jb25maWRlbmNlX2xhYmVsKGNvbmZpZGVuY2UpOgogICAgY29uZiA9IHN0cihjb25maWRlbmNlIG9yICJDIikudXBwZXIoKQogICAgaWYgY29uZiA9PSAiQSI6CiAgICAgICAgcmV0dXJuICJBIgogICAgaWYgY29uZiA9PSAiQiI6CiAgICAgICAgcmV0dXJuICJCIgogICAgcmV0dXJuICJDIgoKCmRlZiBfY29tcGFjdF9lbnRyeShlbnRyeV90eXBlKToKICAgIHRleHQgPSBzdHIoZW50cnlfdHlwZSBvciAiIikuc3RyaXAoKS5sb3dlcigpCiAgICBpZiB0ZXh0ID09ICJtb21lbnR1bSBjb250aW51YXRpb24iOgogICAgICAgIHJldHVybiAiTW9tZW50dW0gY29udGludWF0aW9uIgogICAgaWYgdGV4dCA9PSAiZGlwIHJlY292ZXJ5IHNldHVwIjoKICAgICAgICByZXR1cm4gIkRpcCByZWNvdmVyeSIKICAgIHJldHVybiBzdHIoZW50cnlfdHlwZSBvciAiTi9BIikKCgpkZWYgX3JzaV9tZWFuaW5nKHJzaV92YWx1ZSk6CiAgICBpZiByc2lfdmFsdWUgaXMgTm9uZToKICAgICAgICByZXR1cm4gTm9uZQogICAgdHJ5OgogICAgICAgIHIgPSBmbG9hdChyc2lfdmFsdWUpCiAgICBleGNlcHQgKFR5cGVFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIGlmIHIgPCAzNToKICAgICAgICByZXR1cm4gIlJTSSBvdmVyc29sZCIKICAgIGlmIHIgPCA1MDoKICAgICAgICByZXR1cm4gIlJTSSB3ZWFrIgogICAgaWYgciA8IDY1OgogICAgICAgIHJldHVybiAiUlNJIGhlYWx0aHkiCiAgICBpZiByIDwgNzU6CiAgICAgICAgcmV0dXJuICJSU0kgc3Ryb25nIgogICAgcmV0dXJuICJSU0kgb3ZlcmJvdWdodCIKCgpkZWYgX21hY2RfbWVhbmluZyhtYWNkX2hpc3RfdmFsdWUpOgogICAgaWYgbWFjZF9oaXN0X3ZhbHVlIGlzIE5vbmU6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHRyeToKICAgICAgICBoID0gZmxvYXQobWFjZF9oaXN0X3ZhbHVlKQogICAgZXhjZXB0IChUeXBlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHJldHVybiBOb25lCiAgICBpZiBoID4gMC4wMToKICAgICAgICByZXR1cm4gIk1BQ0QgYnVsbGlzaCBzdHJvbmciCiAgICBpZiBoID4gMDoKICAgICAgICByZXR1cm4gIk1BQ0QgYnVsbGlzaCIKICAgIGlmIGggPiAtMC4wMToKICAgICAgICByZXR1cm4gIk1BQ0QgbmV1dHJhbCIKICAgIHJldHVybiAiTUFDRCBiZWFyaXNoIgoKCmRlZiBfcHJpb3JpdHlfZnJvbV9zY29yZShzY29yZSk6CiAgICB0cnk6CiAgICAgICAgcyA9IGZsb2F0KHNjb3JlIG9yIDApCiAgICBleGNlcHQgKFR5cGVFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgcmV0dXJuICJQMyIKICAgIGlmIHMgPj0gOTA6CiAgICAgICAgcmV0dXJuICJQMSIKICAgIGlmIHMgPj0gODA6CiAgICAgICAgcmV0dXJuICJQMiIKICAgIHJldHVybiAiUDMiCgoKZGVmIF9kYXRhX2FnZV90ZXh0KGxhc3RfdHJhZGVfdW5peCk6CiAgICB0cnk6CiAgICAgICAgdHMgPSBpbnQoZmxvYXQobGFzdF90cmFkZV91bml4KSkKICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICByZXR1cm4gIk4vQSIKICAgIGlmIHRzIDw9IDA6CiAgICAgICAgcmV0dXJuICJOL0EiCiAgICBub3dfdHMgPSBpbnQoZGF0ZXRpbWUudXRjbm93KCkudGltZXN0YW1wKCkpCiAgICBhZ2Vfc2VjID0gbWF4KDAsIG5vd190cyAtIHRzKQogICAgaWYgYWdlX3NlYyA8IDYwOgogICAgICAgIHJldHVybiBmInthZ2Vfc2VjfXMiCiAgICBpZiBhZ2Vfc2VjIDwgMzYwMDoKICAgICAgICByZXR1cm4gZiJ7YWdlX3NlYyAvLyA2MH1tIgogICAgcmV0dXJuIGYie2FnZV9zZWMgLy8gMzYwMH1oIgoKCmRlZiBfaW52YWxpZGF0aW9uX2Zyb21fcmlza19wbGFuKHJpc2tfcGxhbik6CiAgICByYXcgPSBzdHIocmlza19wbGFuIG9yICIiKS5zdHJpcCgpCiAgICBpZiBub3QgcmF3OgogICAgICAgIHJldHVybiAiVGhlc2lzIGJyZWFrIgogICAgcmV0dXJuIHJhdy5zcGxpdCgifCIsIDEpWzBdLnN0cmlwKCkKCgpkZWYgZm9ybWF0X3NpZ25hbCh0b2tlbl9kYXRhLCBjb21wYWN0OiBib29sID0gVHJ1ZSk6CiAgICBzZXAgPSAi4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBIgogICAgc3ltYm9sID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJzeW1ib2wiLCAiVU5LTk9XTiIpKS51cHBlcigpCiAgICBzY29yZSA9IGZsb2F0KHRva2VuX2RhdGEuZ2V0KCJzY29yZSIsIDApIG9yIDApCiAgICBsaXF1aWRpdHkgPSBmbG9hdCh0b2tlbl9kYXRhLmdldCgibGlxdWlkaXR5IiwgMCkgb3IgMCkKICAgIHZvbHVtZV8yNGggPSBmbG9hdCh0b2tlbl9kYXRhLmdldCgidm9sdW1lXzI0aCIsIDApIG9yIDApCiAgICBob2xkZXJzID0gX2ZtdF9ob2xkZXJzKHRva2VuX2RhdGEuZ2V0KCJob2xkZXJzIiwgIk4vQSIpKQogICAgdHJlbmQgPSB0b2tlbl9kYXRhLmdldCgidHJlbmQiLCAiVW5rbm93biIpCiAgICBlbnRyeV90eXBlID0gX2NvbXBhY3RfZW50cnkodG9rZW5fZGF0YS5nZXQoImVudHJ5X3R5cGUiLCAiTi9BIikpCiAgICBjb25maWRlbmNlID0gdG9rZW5fZGF0YS5nZXQoImNvbmZpZGVuY2UiLCAiQyIpCiAgICByZWdpbWVfbGFiZWwgPSBzdHIodG9rZW5fZGF0YS5nZXQoInJlZ2ltZV9sYWJlbCIsICJVTktOT1dOIikpCiAgICBwcm9maWxlID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJwcm9maWxlIiwgIlNUUkFURUdJQyIpKS51cHBlcigpCiAgICBjaGFuZ2VfMjRoID0gdG9rZW5fZGF0YS5nZXQoImNoYW5nZV8yNGgiKQogICAgcnNpID0gdG9rZW5fZGF0YS5nZXQoInJzaSIpCiAgICBtYWNkX2hpc3QgPSB0b2tlbl9kYXRhLmdldCgibWFjZF9oaXN0IikKICAgIG1hcmtldF9jYXAgPSB0b2tlbl9kYXRhLmdldCgibWFya2V0X2NhcCIpCiAgICBmZHYgPSB0b2tlbl9kYXRhLmdldCgiZmR2IikKICAgIHdhbGxldF9maXQgPSBzdHIodG9rZW5fZGF0YS5nZXQoIndhbGxldF9maXQiKSBvciAiVzIiKQogICAgcmlza19wbGFuID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJyaXNrX3BsYW4iKSBvciAiU0wgLTEwJSB8IFRQICsxMi8rMjUgfCBUcmFpbCAxMCUiKQogICAgcm90YXRpb25fcGxhbiA9IHN0cih0b2tlbl9kYXRhLmdldCgicm90YXRpb25fcGxhbiIpIG9yICJSb3RhdGUgcHJvZml0cyB0byBXMS9VU0RDIHBlciBwbGFuIikKICAgIGxhc3RfdHJhZGVfdW5peCA9IHRva2VuX2RhdGEuZ2V0KCJsYXN0X3RyYWRlX3VuaXgiKQoKICAgIHNjb3JlX2xpbmUgPSBmIntzY29yZTouMWZ9LzEwMCB7X3Njb3JlX2JhcihzY29yZSl9IgogICAgY29uZmlkZW5jZV9saW5lID0gX2NvbmZpZGVuY2VfbGFiZWwoY29uZmlkZW5jZSkKICAgIGNoYW5nZV9saW5lID0gX2ZtdF9wY3QoY2hhbmdlXzI0aCkKICAgIHByaW9yaXR5ID0gX3ByaW9yaXR5X2Zyb21fc2NvcmUoc2NvcmUpCiAgICBjYXBfdmFsdWUgPSBtYXJrZXRfY2FwIGlmIGlzaW5zdGFuY2UobWFya2V0X2NhcCwgKGludCwgZmxvYXQpKSBhbmQgbWFya2V0X2NhcCA+IDAgZWxzZSBmZHYKICAgIGFjdGlvbiA9ICJFTlRFUiBOT1ciIGlmIHNjb3JlID49IDc1IGVsc2UgIldBVENIIgogICAgYWN0aW9uX2Vtb2ppID0gIvCfn6IiIGlmIHNjb3JlID49IDc1IGVsc2UgIvCfn6EiCiAgICByZWdpbWVfZW1vamkgPSAi8J+foiIgaWYgIk9OIiBpbiByZWdpbWVfbGFiZWwgZWxzZSAoIvCflLQiIGlmICJPRkYiIGluIHJlZ2ltZV9sYWJlbCBlbHNlICLwn5+hIikKICAgIGludmFsaWRhdGlvbiA9IF9pbnZhbGlkYXRpb25fZnJvbV9yaXNrX3BsYW4ocmlza19wbGFuKQoKICAgICMgRW50cnkgcHJpY2UgYW5kIHRhcmdldHMKICAgIHByaWNlID0gZmxvYXQodG9rZW5fZGF0YS5nZXQoInByaWNlIikgb3IgMCkKICAgIGVudHJ5X2Rpc3BsYXkgPSBfZm10X3ByaWNlX3ByZWNpc2UocHJpY2UpIGlmIHByaWNlID4gMCBlbHNlICJOL0EiCiAgICBpZiBwcmljZSA+IDA6CiAgICAgICAgdGFyZ2V0MSA9IF9mbXRfcHJpY2VfcHJlY2lzZShwcmljZSAqIDEuMTIpCiAgICAgICAgdGFyZ2V0MiA9IF9mbXRfcHJpY2VfcHJlY2lzZShwcmljZSAqIDEuMjUpCiAgICAgICAgc3RvcCA9IF9mbXRfcHJpY2VfcHJlY2lzZShwcmljZSAqIDAuOTApCiAgICBlbHNlOgogICAgICAgIHRhcmdldDEgPSB0YXJnZXQyID0gc3RvcCA9ICJOL0EiCgogICAgbGluZXMgPSBbCiAgICAgICAgZiI8Yj7wn5OLIFtTSUdOQUxdOiBNRU1FQ09JTiBTRVRVUDwvYj4iLAogICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfjq8gQ09JTjogJHtfZXNjKHN5bWJvbCl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5OKIFBST0ZJTEU6IHtfZXNjKHByb2ZpbGUpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+4q2QIFNDT1JFOiB7X2VzYyhzY29yZV9saW5lKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkrAgTUFSS0VUQ0FQOiB7X2VzYyhfZm10X3VzZF9jb21wYWN0KGNhcF92YWx1ZSkpfSB8IDI0SCB7X2VzYyhjaGFuZ2VfbGluZSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5KnIExJUVVJRElUWToge19lc2MoX2ZtdF91c2RfY29tcGFjdChsaXF1aWRpdHkpKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntyZWdpbWVfZW1vaml9IFJFR0lNRToge19lc2MocmVnaW1lX2xhYmVsKX0gfCBHUkFERSB7X2VzYyhjb25maWRlbmNlX2xpbmUpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPnthY3Rpb25fZW1vaml9IFNJR05BTDoge19lc2MoYWN0aW9uKX08L2NvZGU+IiwKICAgIF0KCiAgICBpZiBub3QgY29tcGFjdDoKICAgICAgICB0ZWNoX3BhcnRzID0gW3ggZm9yIHggaW4gW19yc2lfbWVhbmluZyhyc2kpLCBfbWFjZF9tZWFuaW5nKG1hY2RfaGlzdCldIGlmIHhdCiAgICAgICAgaWYgdGVjaF9wYXJ0czoKICAgICAgICAgICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+8J+TiCBNT01FTlRVTToge19lc2MoJyB8ICcuam9pbih0ZWNoX3BhcnRzKSl9PC9jb2RlPiIpCiAgICAgICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+8J+RmyBXQUxMRVQgRklUOiB7X2VzYyh3YWxsZXRfZml0KX08L2NvZGU+IikKICAgICAgICBpZiBob2xkZXJzICE9ICJOL0EiOgogICAgICAgICAgICBsaW5lcy5hcHBlbmQoZiI8Y29kZT7wn5GlIEhPTERFUlM6IHtfZXNjKGhvbGRlcnMpfTwvY29kZT4iKQogICAgICAgIGxpbmVzLmFwcGVuZChmIjxjb2RlPvCfmqsgSU5WQUxJRDoge19lc2MoaW52YWxpZGF0aW9uKX08L2NvZGU+IikKCiAgICBsaW5lcyArPSBbCiAgICAgICAgZiI8Y29kZT57c2VwfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+TjSBFbnRyeToge19lc2MoZW50cnlfZGlzcGxheSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn46vIFRhcmdldCAxOiB7X2VzYyh0YXJnZXQxKX0gKCsxMiUpPC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn46vIFRhcmdldCAyOiB7X2VzYyh0YXJnZXQyKX0gKCsyNSUpPC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5uRIFN0b3A6IHtfZXNjKHN0b3ApfSAoLTEwJSk8L2NvZGU+IiwKICAgIF0KCiAgICBpZiBub3QgY29tcGFjdDoKICAgICAgICBsaW5lcyArPSBbCiAgICAgICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5OLIFJJU0s6IHtfZXNjKHJpc2tfcGxhbil9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+UhCBST1RBVElPTjoge19lc2Mocm90YXRpb25fcGxhbil9PC9jb2RlPiIsCiAgICAgICAgXQoKICAgIHJldHVybiAiXG4iLmpvaW4obGluZXMpCgoKZGVmIGZvcm1hdF9ydW5uZXJfd2F0Y2godG9rZW5fZGF0YSwgY29tcGFjdDogYm9vbCA9IFRydWUpOgogICAgc3ltYm9sID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJzeW1ib2wiKSBvciAiVU5LTk9XTiIpLnVwcGVyKCkKICAgIG5hbWUgPSBzdHIodG9rZW5fZGF0YS5nZXQoIm5hbWUiKSBvciBzeW1ib2wpCiAgICBhZ2VfaG91cnMgPSB0b2tlbl9kYXRhLmdldCgiYWdlX2hvdXJzIikKICAgIG1hcmtldF9jYXAgPSB0b2tlbl9kYXRhLmdldCgibWFya2V0X2NhcCIpCiAgICBmZHYgPSB0b2tlbl9kYXRhLmdldCgiZmR2IikKICAgIGxpcXVpZGl0eSA9IHRva2VuX2RhdGEuZ2V0KCJsaXF1aWRpdHkiKQogICAgdm9sdW1lXzI0aCA9IHRva2VuX2RhdGEuZ2V0KCJ2b2x1bWVfMjRoIikKICAgIGNoYW5nZV8yNGggPSB0b2tlbl9kYXRhLmdldCgiY2hhbmdlXzI0aCIpCiAgICB0eG5zX2gxID0gdG9rZW5fZGF0YS5nZXQoInR4bnNfaDEiKQogICAgd2F0Y2hfc2NvcmUgPSB0b2tlbl9kYXRhLmdldCgid2F0Y2hfc2NvcmUiKQogICAgeF9wcm94eSA9IHRva2VuX2RhdGEuZ2V0KCJ4X3Byb3h5X2xhYmVsIiwgIk4vQSIpCiAgICBuYXJyYXRpdmUgPSB0b2tlbl9kYXRhLmdldCgibmFycmF0aXZlX2xhYmVsIiwgIk4vQSIpCiAgICBub3RlID0gdG9rZW5fZGF0YS5nZXQoIm5vdGUiLCAiIikKICAgIHdhbGxldF9maXQgPSBzdHIodG9rZW5fZGF0YS5nZXQoIndhbGxldF9maXQiKSBvciAiVzMiKQogICAgcmlza19wbGFuID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJyaXNrX3BsYW4iKSBvciAiU21hbGwgc2l6ZSBvbmx5IHwgaGFyZCBzdG9wIHwgcXVpY2sgc2NhbGUtb3V0cyIpCiAgICByb3RhdGlvbl9wbGFuID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJyb3RhdGlvbl9wbGFuIikgb3IgIlJvdGF0ZSB3aW5zIGludG8gVzEvVzIgb3IgVVNEQyIpCiAgICBjYXBfdmFsdWUgPSBtYXJrZXRfY2FwIGlmIGlzaW5zdGFuY2UobWFya2V0X2NhcCwgKGludCwgZmxvYXQpKSBhbmQgbWFya2V0X2NhcCA+IDAgZWxzZSBmZHYKICAgIGNhcF9rZXkgPSAiTUtUX0NBUCIgaWYgaXNpbnN0YW5jZShtYXJrZXRfY2FwLCAoaW50LCBmbG9hdCkpIGFuZCBtYXJrZXRfY2FwID4gMCBlbHNlICJGRFYiCiAgICBhZ2VfdGV4dCA9IGYie2Zsb2F0KGFnZV9ob3Vycyk6LjFmfWgiIGlmIGlzaW5zdGFuY2UoYWdlX2hvdXJzLCAoaW50LCBmbG9hdCkpIGVsc2UgIk4vQSIKICAgIHNjb3JlX3RleHQgPSBmIntmbG9hdCh3YXRjaF9zY29yZSk6LjFmfS8xMDAiIGlmIGlzaW5zdGFuY2Uod2F0Y2hfc2NvcmUsIChpbnQsIGZsb2F0KSkgZWxzZSAiTi9BIgogICAgcm93cyA9IFsKICAgICAgICBfa3YoIlBSSU9SSVRZIiwgIlAyIiksCiAgICAgICAgX2t2KCJTQ09SRSIsIHNjb3JlX3RleHQpLAogICAgICAgIF9rdigiQUdFIiwgYWdlX3RleHQpLAogICAgICAgIF9rdigiUFJJQ0UiLCBmIntfZm10X3VzZF9jb21wYWN0KHRva2VuX2RhdGEuZ2V0KCdwcmljZScpKX0gfCAyNEgge19mbXRfcGN0KGNoYW5nZV8yNGgpfSIpLAogICAgICAgIF9rdihjYXBfa2V5LCBfZm10X3VzZF9jb21wYWN0KGNhcF92YWx1ZSkpLAogICAgICAgIF9rdigiTElRVUlESVRZIiwgX2ZtdF91c2RfY29tcGFjdChsaXF1aWRpdHkpKSwKICAgICAgICBfa3YoIkFDVElPTiIsICJNT05JVE9SIiksCiAgICAgICAgX2t2KCJSRUFTT04iLCAiRnJlc2ggbGlzdGluZyB3aXRoIGFjdGl2ZSBmbG93IiksCiAgICBdCiAgICBpZiBub3QgY29tcGFjdDoKICAgICAgICByb3dzLmV4dGVuZCgKICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgX2t2KCJXQUxMRVQiLCB3YWxsZXRfZml0KSwKICAgICAgICAgICAgICAgIF9rdigiWF9QUk9YWSIsIHhfcHJveHkpLAogICAgICAgICAgICAgICAgX2t2KCJOQVJSQVRJVkUiLCBuYXJyYXRpdmUpLAogICAgICAgICAgICAgICAgX2t2KCJJTlZBTElEIiwgIkZsb3cgY29sbGFwc2UgLyBsaXF1aWRpdHkgZmFkZSIpLAogICAgICAgICAgICAgICAgX2t2KCJSSVNLIiwgcmlza19wbGFuKSwKICAgICAgICAgICAgICAgIF9rdigiUk9UQVRJT04iLCByb3RhdGlvbl9wbGFuKSwKICAgICAgICAgICAgICAgIF9rdigiTk9URSIsIG5vdGUgb3IgIldhdGNobGlzdC1vbmx5IGFsZXJ0LiBOb3QgYSBidXkgc2lnbmFsLiIpLAogICAgICAgICAgICBdCiAgICAgICAgKQogICAgaGVhZGVyID0gX2hlYWRlcl9ibG9jaygKICAgICAgICAiW1NJR05BTF06UlVOTkVSIiwKICAgICAgICBoZWFkZXJfcm93cz1bCiAgICAgICAgICAgIF9rdigiU1lNQk9MIiwgZiIke3N5bWJvbH0iKSwKICAgICAgICAgICAgX2t2KCJUT0tFTiIsIG5hbWUpLAogICAgICAgIF0sCiAgICApCiAgICByZXR1cm4gaGVhZGVyICsgIlxuIiArIF9yZW5kZXJfcHJlKHJvd3MpCgoKZGVmIF93YXRjaGxpc3Rfc3RhdHVzX2xhYmVsKHN0YXR1cyk6CiAgICByYXcgPSBzdHIoc3RhdHVzIG9yICIiKS5zdHJpcCgpCiAgICBpZiBub3QgcmF3OgogICAgICAgIHJldHVybiAiVW5rbm93biIKICAgIHVwcGVyID0gcmF3LnVwcGVyKCkKICAgIGlmIHVwcGVyID09ICJOT0RBVEEiOgogICAgICAgIHJldHVybiAiTm9EYXRhIgogICAgcmV0dXJuIHJhdy50aXRsZSgpCgoKZGVmIF93YXRjaGxpc3Rfc3RhdHVzX2NvZGUoc3RhdHVzKToKICAgIHN0YXR1c19ub3JtID0gX3dhdGNobGlzdF9zdGF0dXNfbGFiZWwoc3RhdHVzKQogICAgbWFwcGluZyA9IHsKICAgICAgICAiTW9tZW50dW0iOiAiTU9NIiwKICAgICAgICAiUmVjbGFpbSI6ICJSRUMiLAogICAgICAgICJCcmVha2Rvd24iOiAiQlJLIiwKICAgICAgICAiUmFuZ2UiOiAiUk5HIiwKICAgICAgICAiVm9sYXRpbGUiOiAiVk9MIiwKICAgICAgICAiSWxsaXF1aWQiOiAiSUxMIiwKICAgICAgICAiTm9EYXRhIjogIk5PRCIsCiAgICAgICAgIlVua25vd24iOiAiVU5LIiwKICAgIH0KICAgIHJldHVybiBtYXBwaW5nLmdldChzdGF0dXNfbm9ybSwgIlVOSyIpLCBzdGF0dXNfbm9ybQoKCmRlZiBmb3JtYXRfd2F0Y2hsaXN0X3NpZ25hbCh0b2tlbl9kYXRhLCBjb21wYWN0OiBib29sID0gVHJ1ZSk6CiAgICBzZXAgPSAi4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBIgogICAgc3ltYm9sID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJzeW1ib2wiKSBvciAiVU5LTk9XTiIpLnVwcGVyKCkKICAgIHN0YXR1c19jb2RlLCBzdGF0dXNfbGFiZWwgPSBfd2F0Y2hsaXN0X3N0YXR1c19jb2RlKHRva2VuX2RhdGEuZ2V0KCJzdGF0dXMiKSkKICAgIHJlYXNvbiA9IHN0cih0b2tlbl9kYXRhLmdldCgicmVhc29uIikgb3IgIlN0YXR1cyBjb25kaXRpb24gdHJpZ2dlcmVkLiIpCiAgICBtYXJrZXRfY2FwID0gdG9rZW5fZGF0YS5nZXQoIm1hcmtldF9jYXAiKQogICAgZmR2ID0gdG9rZW5fZGF0YS5nZXQoImZkdiIpCiAgICBjYXBfdmFsdWUgPSBtYXJrZXRfY2FwIGlmIGlzaW5zdGFuY2UobWFya2V0X2NhcCwgKGludCwgZmxvYXQpKSBhbmQgbWFya2V0X2NhcCA+IDAgZWxzZSBmZHYKICAgIHVwc2lkZSA9IHN0cih0b2tlbl9kYXRhLmdldCgidXBzaWRlX3BvdGVudGlhbCIpIG9yICJNZWRpdW0iKS50aXRsZSgpCiAgICBmYWlsdXJlID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJmYWlsdXJlX3Jpc2siKSBvciAiTWVkaXVtIikudGl0bGUoKQogICAgd2FsbGV0X2ZpdCA9IHN0cih0b2tlbl9kYXRhLmdldCgid2FsbGV0X2ZpdCIpIG9yICJXMyIpCiAgICByaXNrX3BsYW4gPSBzdHIodG9rZW5fZGF0YS5nZXQoInJpc2tfcGxhbiIpIG9yICJTbWFsbCBzaXplIG9ubHkgfCBoYXJkIHN0b3AgfCBxdWljayBzY2FsZS1vdXRzIikKICAgIHJvdGF0aW9uX3BsYW4gPSBzdHIodG9rZW5fZGF0YS5nZXQoInJvdGF0aW9uX3BsYW4iKSBvciAiUm90YXRlIHdpbnMgaW50byBXMS9XMiBvciBVU0RDIikKICAgIGNoYW5nZV8yNGggPSB0b2tlbl9kYXRhLmdldCgiY2hhbmdlXzI0aCIpCiAgICBjaGFuZ2VfbGluZSA9IF9mbXRfcGN0KGNoYW5nZV8yNGgpCiAgICBsaXF1aWRpdHkgPSBmbG9hdCh0b2tlbl9kYXRhLmdldCgibGlxdWlkaXR5Iikgb3IgMCkKICAgIHByaWNlID0gZmxvYXQodG9rZW5fZGF0YS5nZXQoInByaWNlIikgb3IgMCkKICAgIGVudHJ5X2Rpc3BsYXkgPSBfZm10X3ByaWNlX3ByZWNpc2UocHJpY2UpIGlmIHByaWNlID4gMCBlbHNlICJOL0EiCgogICAgaWYgc3RhdHVzX2xhYmVsID09ICJCcmVha2Rvd24iOgogICAgICAgIGFjdGlvbiA9ICJBVk9JRCAvIEVYSVQiCiAgICAgICAgYWN0aW9uX2Vtb2ppID0gIvCflLQiCiAgICBlbGlmIHN0YXR1c19sYWJlbCBpbiB7Ik1vbWVudHVtIiwgIlJlY2xhaW0ifToKICAgICAgICBhY3Rpb24gPSAiV0FUQ0ggRk9SIEVOVFJZIgogICAgICAgIGFjdGlvbl9lbW9qaSA9ICLwn5+hIgogICAgZWxzZToKICAgICAgICBhY3Rpb24gPSAiTU9OSVRPUiIKICAgICAgICBhY3Rpb25fZW1vamkgPSAi4pqqIgoKICAgIGxpbmVzID0gWwogICAgICAgIGYiPGI+8J+RgSBbU0lHTkFMXTogV0FUQ0hMSVNUPC9iPiIsCiAgICAgICAgZiI8Y29kZT57c2VwfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+OryBDT0lOOiAke19lc2Moc3ltYm9sKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfk4ogU1RBVFVTOiB7X2VzYyhzdGF0dXNfbGFiZWwpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+SsCBNQVJLRVRDQVA6IHtfZXNjKF9mbXRfdXNkX2NvbXBhY3QoY2FwX3ZhbHVlKSl9IHwgMjRIIHtfZXNjKGNoYW5nZV9saW5lKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkqcgTElRVUlESVRZOiB7X2VzYyhfZm10X3VzZF9jb21wYWN0KGxpcXVpZGl0eSkpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPnthY3Rpb25fZW1vaml9IFNJR05BTDoge19lc2MoYWN0aW9uKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfk40gRU5UUlk6IHtfZXNjKGVudHJ5X2Rpc3BsYXkpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+TnSBSRUFTT046IHtfZXNjKHJlYXNvbil9PC9jb2RlPiIsCiAgICBdCgogICAgaWYgbm90IGNvbXBhY3Q6CiAgICAgICAgbGluZXMgKz0gWwogICAgICAgICAgICBmIjxjb2RlPntzZXB9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+TiCBVUFNJREU6IHtfZXNjKHVwc2lkZSl9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+4pqg77iPIFJJU0s6IHtfZXNjKGZhaWx1cmUpfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfkZsgV0FMTEVUIEZJVDoge19lc2Mod2FsbGV0X2ZpdCl9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+aqyBJTlZBTElEOiBCcmVha2Rvd24gLyBsaXF1aWRpdHkgY3JhY2s8L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT57c2VwfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfk4sgUklTSyBQTEFOOiB7X2VzYyhyaXNrX3BsYW4pfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCflIQgUk9UQVRJT046IHtfZXNjKHJvdGF0aW9uX3BsYW4pfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPuKEue+4jyBOT1RFOiBXYXRjaGxpc3Qtb25seSBhbGVydCAobm90IGFuIGF1dG8tYnV5IHNpZ25hbCkuPC9jb2RlPiIsCiAgICAgICAgXQoKICAgIHJldHVybiAiXG4iLmpvaW4obGluZXMpCgoKZGVmIGZvcm1hdF9sZWdhY3lfcmVjb3ZlcnkodG9rZW5fZGF0YSk6CiAgICBzZXAgPSAi4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBIgogICAgc3ltYm9sID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJzeW1ib2wiLCAiVU5LTk9XTiIpKS51cHBlcigpCiAgICBwcmljZSA9IGZsb2F0KHRva2VuX2RhdGEuZ2V0KCJwcmljZSIsIDApIG9yIDApCiAgICBjaGFuZ2VfMjRoID0gdG9rZW5fZGF0YS5nZXQoImNoYW5nZV8yNGgiKQogICAgbGlxdWlkaXR5ID0gZmxvYXQodG9rZW5fZGF0YS5nZXQoImxpcXVpZGl0eSIsIDApIG9yIDApCiAgICBtYXJrZXRfY2FwID0gdG9rZW5fZGF0YS5nZXQoIm1hcmtldF9jYXAiKQogICAgZmR2ID0gdG9rZW5fZGF0YS5nZXQoImZkdiIpCiAgICBwYXR0ZXJuX2xhYmVsID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJwYXR0ZXJuX2xhYmVsIikgb3IgIlJldmVyc2FsIikKICAgIHBhdHRlcm5fc3RhdHVzID0gc3RyKHRva2VuX2RhdGEuZ2V0KCJwYXR0ZXJuX3N0YXR1cyIpIG9yICJGb3JtaW5nIikKICAgIHNvbF9zdGF0dXMgPSBzdHIodG9rZW5fZGF0YS5nZXQoInNvbF9zdGF0dXMiKSBvciAiTkVVVFJBTCIpCiAgICBhZ2VfZGF5cyA9IHRva2VuX2RhdGEuZ2V0KCJhZ2VfZGF5cyIpCgogICAgIyBNYXJrZXRjYXAgZGlzcGxheSAocHJlZmVyIG1hcmtldF9jYXAsIGZhbGwgYmFjayB0byBmZHYpCiAgICBjYXBfdmFsdWUgPSBtYXJrZXRfY2FwIGlmIGlzaW5zdGFuY2UobWFya2V0X2NhcCwgKGludCwgZmxvYXQpKSBhbmQgbWFya2V0X2NhcCA+IDAgZWxzZSBmZHYKICAgIGNhcF9kaXNwbGF5ID0gX2ZtdF91c2RfY29tcGFjdChjYXBfdmFsdWUpIGlmIGNhcF92YWx1ZSBlbHNlICJOL0EiCgogICAgIyBGb3JtYXQgZW50cnkgcHJpY2UgZm9yIHRhcmdldHMvc3RvcHMKICAgIGlmIHByaWNlID49IDEuMDoKICAgICAgICBkaXNwbGF5X3ByaWNlID0gZiIke3ByaWNlOi40Zn0iCiAgICBlbGlmIHByaWNlID49IDAuMDE6CiAgICAgICAgZGlzcGxheV9wcmljZSA9IGYiJHtwcmljZTouNmZ9IgogICAgZWxpZiBwcmljZSA+IDA6CiAgICAgICAgZGlzcGxheV9wcmljZSA9IGYiJHtwcmljZTouOGZ9IgogICAgZWxzZToKICAgICAgICBkaXNwbGF5X3ByaWNlID0gIk4vQSIKCiAgICBjaGFuZ2VfbGluZSA9IF9mbXRfcGN0KGNoYW5nZV8yNGgpCiAgICBpZiBwcmljZSA+PSAwLjAxOgogICAgICAgIHRhcmdldDEgPSBmIiR7cHJpY2UgKiAxLjU6LjZmfSIgaWYgcHJpY2UgPiAwIGVsc2UgIk4vQSIKICAgICAgICB0YXJnZXQyID0gZiIke3ByaWNlICogMi4wOi42Zn0iIGlmIHByaWNlID4gMCBlbHNlICJOL0EiCiAgICAgICAgc3RvcCA9IGYiJHtwcmljZSAqIDAuNTouNmZ9IiBpZiBwcmljZSA+IDAgZWxzZSAiTi9BIgogICAgZWxzZToKICAgICAgICB0YXJnZXQxID0gZiIke3ByaWNlICogMS41Oi44Zn0iLnJzdHJpcCgiMCIpLnJzdHJpcCgiLiIpIGlmIHByaWNlID4gMCBlbHNlICJOL0EiCiAgICAgICAgdGFyZ2V0MiA9IGYiJHtwcmljZSAqIDIuMDouOGZ9Ii5yc3RyaXAoIjAiKS5yc3RyaXAoIi4iKSBpZiBwcmljZSA+IDAgZWxzZSAiTi9BIgogICAgICAgIHN0b3AgPSBmIiR7cHJpY2UgKiAwLjU6LjhmfSIucnN0cmlwKCIwIikucnN0cmlwKCIuIikgaWYgcHJpY2UgPiAwIGVsc2UgIk4vQSIKCiAgICBhZ2VfdGV4dCA9IGYie2ludChhZ2VfZGF5cyl9ZCIgaWYgaXNpbnN0YW5jZShhZ2VfZGF5cywgKGludCwgZmxvYXQpKSBhbmQgYWdlX2RheXMgPiAwIGVsc2UgIj45MGQiCiAgICBzb2xfZW1vamkgPSAi8J+foiIgaWYgc29sX3N0YXR1cyA9PSAiUklTS19PTiIgZWxzZSAoIvCflLQiIGlmICJPRkYiIGluIHNvbF9zdGF0dXMgZWxzZSAi8J+foSIpCgogICAgbGluZXMgPSBbCiAgICAgICAgZiI8Yj7wn5OLIFtTSUdOQUxdOiBMRUdBQ1kgUkVDT1ZFUlk8L2I+IiwKICAgICAgICBmIjxjb2RlPntzZXB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn46vIENPSU46ICR7X2VzYyhzeW1ib2wpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+SsCBNQVJLRVRDQVA6IHtfZXNjKGNhcF9kaXNwbGF5KX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfk4ggMjRIIENIRzoge19lc2MoY2hhbmdlX2xpbmUpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+SpyBMSVFVSURJVFk6IHtfZXNjKF9mbXRfdXNkX2NvbXBhY3QobGlxdWlkaXR5KSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5SlIFBBVFRFUk46IHtfZXNjKHBhdHRlcm5fbGFiZWwpfSAoe19lc2MocGF0dGVybl9zdGF0dXMpfSk8L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCflZAgQUdFOiB7X2VzYyhhZ2VfdGV4dCl9IChlc3RhYmxpc2hlZCBjb2luKTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPuKchSBCVVkgU0lHTkFMIChMRUdBQ1kgUkVDT1ZFUlkpPC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5KhIEVzdGFibGlzaGVkIGNvaW4gd2l0aCBmcmVzaCByZXZlcnNhbCBwYXR0ZXJuICsgdm9sdW1lIHNwaWtlPC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5OKIENvbW11bml0eSBzdGlsbCBhY3RpdmUsID45MCBkYXlzIHByb3ZlbiBuYXJyYXRpdmU8L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntzb2xfZW1vaml9IFNPTCBTdGF0dXM6IHtfZXNjKHNvbF9zdGF0dXMpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3NlcH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfk40gRW50cnk6IHtfZXNjKGRpc3BsYXlfcHJpY2UpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+OryBUYXJnZXQgMToge19lc2ModGFyZ2V0MSl9ICgrNTAlKTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+OryBUYXJnZXQgMjoge19lc2ModGFyZ2V0Mil9ICgrMTAwJSk8L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfm5EgU3RvcDoge19lc2Moc3RvcCl9ICgtNTAlKTwvY29kZT4iLAogICAgXQogICAgcmV0dXJuICJcbiIuam9pbihsaW5lcykKCgpkZWYgZm9ybWF0X3dhdGNobGlzdF9zdW1tYXJ5KHJvd3MpOgogICAgaWYgbm90IHJvd3M6CiAgICAgICAgcmV0dXJuIF9oZWFkZXJfYmxvY2soIltTSUdOQUxdOldBVENITElTVC1TVU1NQVJZIikgKyAiXG4iICsgX3JlbmRlcl9wcmUoWyJObyB3YXRjaGxpc3QgdG9rZW5zIGNvbmZpZ3VyZWQuIl0pCgogICAgb3JkZXIgPSB7Ik1vbWVudHVtIjogMCwgIlJlY2xhaW0iOiAxLCAiQnJlYWtkb3duIjogMiwgIlJhbmdlIjogMywgIlZvbGF0aWxlIjogNCwgIklsbGlxdWlkIjogNSwgIk5vRGF0YSI6IDZ9CiAgICBzb3J0ZWRfcm93cyA9IHNvcnRlZCgKICAgICAgICByb3dzLAogICAgICAgIGtleT1sYW1iZGEgcjogKAogICAgICAgICAgICBvcmRlci5nZXQoc3RyKHIuZ2V0KCJzdGF0dXMiKSBvciAiIiksIDkpLAogICAgICAgICAgICAtKGZsb2F0KHIuZ2V0KCJ2b2x1bWVfMjRoIikgb3IgMCkpLAogICAgICAgICksCiAgICApCgogICAgdG90YWwgPSBsZW4oc29ydGVkX3Jvd3MpCiAgICBsaXZlID0gc3VtKDEgZm9yIHIgaW4gc29ydGVkX3Jvd3MgaWYgYm9vbChyLmdldCgiaGFzX2xpdmVfZGF0YSIsIFRydWUpKSkKICAgIG5vX2RhdGEgPSB0b3RhbCAtIGxpdmUKICAgIGxpbmVzID0gW2YiQ09WRVJBR0UgICB7bGl2ZX0ve3RvdGFsfSBsaXZlICh7bm9fZGF0YX0gbm8tZGF0YSkiXQogICAgZm9yIGlkeCwgcm93IGluIGVudW1lcmF0ZShzb3J0ZWRfcm93cywgc3RhcnQ9MSk6CiAgICAgICAgc3RhdHVzX2NvZGUsIHN0YXR1c19sYWJlbCA9IF93YXRjaGxpc3Rfc3RhdHVzX2NvZGUocm93LmdldCgic3RhdHVzIikpCiAgICAgICAgc3ltYm9sID0gc3RyKHJvdy5nZXQoInN5bWJvbCIpIG9yICJVTktOT1dOIikudXBwZXIoKQogICAgICAgIGNoMjQgPSBfZm10X3BjdChyb3cuZ2V0KCJjaGFuZ2VfMjRoIikpCiAgICAgICAgbGlxID0gX2ZtdF91c2RfY29tcGFjdChyb3cuZ2V0KCJsaXF1aWRpdHkiKSkKICAgICAgICB2b2wgPSBfZm10X3VzZF9jb21wYWN0KHJvdy5nZXQoInZvbHVtZV8yNGgiKSkKICAgICAgICBsaW5lcy5hcHBlbmQoZiJ7aWR4OjAyZH0ge3N5bWJvbDo8MTB9IHtzdGF0dXNfY29kZTo8M30gKHtzdGF0dXNfbGFiZWw6PDl9KSAyNEgge2NoMjQ6Pjh9IExJUSB7bGlxOj44fSBWT0wge3ZvbDo+OH0iKQoKICAgIHJldHVybiBfaGVhZGVyX2Jsb2NrKCJbU0lHTkFMXTpXQVRDSExJU1QtU1VNTUFSWSIpICsgIlxuIiArIF9yZW5kZXJfcHJlKGxpbmVzKQo="""

def deploy(b64, path):
    data = base64.b64decode(b64)
    try:
        ast.parse(data.decode("utf-8"))
        print(f"  {path} syntax OK - {len(data)} chars")
    except SyntaxError as e:
        print(f"  SYNTAX ERROR in {path}: {e}")
        sys.exit(1)
    with open(path, "wb") as f:
        f.write(data)
    print(f"  Written: {path}")

deploy(FORMAT_B64, "/root/memecoin_engine/utils/format.py")
print("\nDeploy complete.")
