#!/usr/bin/env python3
import base64, os

CONTENT = """IiIiCkp1cGl0ZXIgUGVycHMgU09MIExldmVyYWdlIEFzc2lzdGFudApSZWFkLW9ubHkgcG9zaXRpb24gdHJhY2tlciBmb3IgSnVwaXRlciBwZXJwZXR1YWxzIG9uIFNvbGFuYS4KRmV0Y2hlcyBwb3NpdGlvbiBkYXRhIHZpYSBKdXBpdGVyIFBlcnBzIEFQSSBhbmQgb24tY2hhaW4gUlBDLgoiIiIKCmltcG9ydCBsb2dnaW5nCmltcG9ydCBtYXRoCmltcG9ydCB0aW1lCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lem9uZQoKaW1wb3J0IHJlcXVlc3RzCgojIOKUgOKUgCBDb25zdGFudHMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpXQUxMRVRfQUREUkVTUyA9ICI2WWVBVEI3NUF5SktNOHVqdjNxUVh0ekNLckFDbVFnenBnZjRFbWppaGhGNCIKU09MQU5BX1JQQyA9ICJodHRwczovL2FwaS5tYWlubmV0LWJldGEuc29sYW5hLmNvbSIKCiMgSnVwaXRlciBQZXJwcyBBUEkKSlVQSVRFUl9QRVJQU19BUEkgPSAiaHR0cHM6Ly9wZXJwcy1hcGkuanVwLmFnL3YxIgoKIyBBbGVydCB0aHJlc2hvbGRzCkxJUV9XQVJOX1BDVCA9IDE1LjAgICAgICAgICAgIyB3YXJuIGlmIDwgMTUlIGF3YXkgZnJvbSBsaXF1aWRhdGlvbgpQUklDRV9UQVJHRVRTID0gWzEwMC4wLCAxMjAuMCwgMTYwLjBdCkZVTkRJTkdfV0FSTl9QQ1QgPSAwLjA1ICAgICAgIyB3YXJuIGlmIGZ1bmRpbmcgcmF0ZSA+IDAuMDUlCkZVTkRJTkdfSElHSF9QQ1QgPSAwLjA2ICAgICAgIyBzaG93IGNvc3QgaW1wYWN0IGFib3ZlIHRoaXMKTU9OVEhMWV9BRERfVVNEID0gMjUwLjAKTU9OVEhMWV9MRVZFUkFHRSA9IDMuMApDSEVDS19JTlRFUlZBTF9TRUNPTkRTID0gNjAKTU9OVEhMWV9SRU1JTkRFUl9EQVlTID0gMzAKCiMgUmlzayB6b25lIHRocmVzaG9sZHMgKGxpcSBkaXN0YW5jZSAlKQpTQUZFX0xJUV9ESVNUQU5DRSA9IDQwLjAgICAgICAgIyA+IDQwJSA9IHNhZmUKTkVVVFJBTF9MSVFfRElTVEFOQ0UgPSAyNS4wICAgICMgMjUtNDAlID0gbmV1dHJhbApXQVJOX0xJUV9ESVNUQU5DRSA9IDE1LjAgICAgICAgIyAxNS0yNSUgPSBhZ2dyZXNzaXZlCkRBTkdFUl9MSVFfRElTVEFOQ0UgPSAxNS4wICAgICAjIDwgMTUlID0gYmxvY2tlZAoKIyBMZXZlcmFnZSBvcHRpb25zClNBRkVfTEVWRVJBR0UgPSAyLjAKTkVVVFJBTF9MRVZFUkFHRSA9IDMuMApBR0dSRVNTSVZFX0xFVkVSQUdFID0gNC41Ck1BWF9MRVZFUkFHRSA9IDUuMAoKIyBWb2xhdGlsaXR5IHRocmVzaG9sZHMKVk9MX1dBUk5JTkdfVEhSRVNIT0xEID0gMTIuMCAgICMgJSDigJQgd2FybiBpZiBhYm92ZQpWT0xfSElHSF9USFJFU0hPTEQgPSAxMC4wICAgICAgIyAlIOKAlCBzdWdnZXN0IGxvd2VyIGxldmVyYWdlCgojIFByaWNlIHpvbmVzIHRvIGFuYWx5c2UgaW4gL3ByaWNlem9uZXMKUFJJQ0VfWk9ORV9MRVZFTFMgPSBbMTAwLjAsIDc1LjAsIDYwLjBdCgojIOKUgOKUgCBTZXBhcmF0b3Ig4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpTRVAgPSAi4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBIgoKIyDilIDilIAgU3RhdGUg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpfc3RhdGUgPSB7CiAgICAibGFzdF9tb250aGx5X3JlbWluZGVyX3RzIjogMC4wLAogICAgInRhcmdldHNfaGl0Ijogc2V0KCksICAgICAgICAgICMgcHJpY2UgdGFyZ2V0cyBhbHJlYWR5IGFsZXJ0ZWQKICAgICJsYXN0X2xpcV9hbGVydF90cyI6IDAuMCwKICAgICJsYXN0X2Z1bmRpbmdfYWxlcnRfdHMiOiAwLjAsCn0KCgojIOKUgOKUgCBGZXRjaCBwb3NpdGlvbiBmcm9tIEp1cGl0ZXIgUGVycHMgQVBJIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIGZldGNoX2p1cGl0ZXJfcG9zaXRpb24oKToKICAgICIiIgogICAgRmV0Y2ggb3BlbiBTT0wtTE9ORyBwb3NpdGlvbiBmb3Igd2FsbGV0IGZyb20gSnVwaXRlciBQZXJwcyBBUEkuCiAgICBSZXR1cm5zIG5vcm1hbGl6ZWQgZGljdCBvciBOb25lLgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgdXJsID0gZiJ7SlVQSVRFUl9QRVJQU19BUEl9L3Bvc2l0aW9ucyIKICAgICAgICBwYXJhbXMgPSB7IndhbGxldEFkZHJlc3MiOiBXQUxMRVRfQUREUkVTU30KICAgICAgICByID0gcmVxdWVzdHMuZ2V0KHVybCwgcGFyYW1zPXBhcmFtcywgdGltZW91dD0xMCkKICAgICAgICBpZiByLnN0YXR1c19jb2RlICE9IDIwMDoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBkYXRhID0gci5qc29uKCkgb3Ige30KICAgICAgICBwb3NpdGlvbnMgPSBkYXRhLmdldCgiZGF0YUxpc3QiKSBvciBkYXRhLmdldCgicG9zaXRpb25zIikgb3IgW10KICAgICAgICAjIEZpbmQgb3BlbiBTT0wgbG9uZwogICAgICAgIGZvciBwb3MgaW4gcG9zaXRpb25zOgogICAgICAgICAgICBtYXJrZXQgPSBzdHIocG9zLmdldCgibWFya2V0Iikgb3IgcG9zLmdldCgibWFya2V0U3ltYm9sIikgb3IgIiIpLnVwcGVyKCkKICAgICAgICAgICAgc2lkZSA9IHN0cihwb3MuZ2V0KCJzaWRlIikgb3IgIiIpLnVwcGVyKCkKICAgICAgICAgICAgaWYgIlNPTCIgaW4gbWFya2V0IGFuZCBzaWRlIGluICgiTE9ORyIsICJCVVkiKToKICAgICAgICAgICAgICAgIHJldHVybiBfbm9ybWFsaXplX3Bvc2l0aW9uKHBvcykKICAgICAgICAjIElmIG5vIG1hdGNoLCByZXR1cm4gZmlyc3Qgb3BlbiBwb3NpdGlvbgogICAgICAgIGlmIHBvc2l0aW9uczoKICAgICAgICAgICAgcmV0dXJuIF9ub3JtYWxpemVfcG9zaXRpb24ocG9zaXRpb25zWzBdKQogICAgICAgIHJldHVybiBOb25lCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2luZy53YXJuaW5nKCJqdXBpdGVyX3BlcnBzOiBmZXRjaCBlcnJvcjogJXMiLCBlKQogICAgICAgIHJldHVybiBOb25lCgoKZGVmIF9ub3JtYWxpemVfcG9zaXRpb24ocG9zKToKICAgICIiIgogICAgTm9ybWFsaXplIHJhdyBKdXBpdGVyIFBlcnBzIHBvc2l0aW9uIGRpY3QgdG8gc3RhbmRhcmQgZmllbGRzLgogICAgSnVwaXRlciBBUEkgcmV0dXJucyBhbGwgbnVtZXJpYyB2YWx1ZXMgYXMgc3RyaW5ncy4KICAgIEFjdHVhbCBmaWVsZHM6IGVudHJ5UHJpY2UsIG1hcmtQcmljZSwgbGlxdWlkYXRpb25QcmljZSwgbGV2ZXJhZ2UsCiAgICBzaXplIChTT0wpLCBjb2xsYXRlcmFsVXNkLCBwbmxBZnRlckZlZXNVc2QsIGJvcnJvd0ZlZXNVc2QsIHNpZGUsIGNyZWF0ZWRUaW1lCiAgICAiIiIKICAgIGRlZiBfZihrZXksIGZhbGxiYWNrPTAuMCk6CiAgICAgICAgdiA9IHBvcy5nZXQoa2V5KQogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIGZsb2F0KHYpIGlmIHYgaXMgbm90IE5vbmUgZWxzZSBmYWxsYmFjawogICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrCgogICAgZW50cnlfcHJpY2UgID0gX2YoImVudHJ5UHJpY2UiKQogICAgbWFya19wcmljZSAgID0gX2YoIm1hcmtQcmljZSIpCiAgICBsaXFfcHJpY2UgICAgPSBfZigibGlxdWlkYXRpb25QcmljZSIpCiAgICBsZXZlcmFnZSAgICAgPSBfZigibGV2ZXJhZ2UiKQoKICAgICMgc2l6ZVVzZERlbHRhIGlzIHRoZSBVU0QgcG9zaXRpb24gc2l6ZSAoaW4gbWljcm8tdW5pdHMsIGRpdmlkZSBieSAxZTYpCiAgICBzaXplX3VzZF9yYXcgPSBfZigic2l6ZVVzZERlbHRhIikKICAgIHNpemVfdXNkID0gc2l6ZV91c2RfcmF3IC8gMV8wMDBfMDAwIGlmIHNpemVfdXNkX3JhdyA+IDEwMDAgZWxzZSBfZigic2l6ZSIpCgogICAgIyBjb2xsYXRlcmFsVXNkIGlzIGluIG1pY3JvLXVuaXRzIHRvbwogICAgY29sbGF0ZXJhbF9yYXcgPSBfZigiY29sbGF0ZXJhbFVzZCIpCiAgICBjb2xsYXRlcmFsID0gY29sbGF0ZXJhbF9yYXcgLyAxXzAwMF8wMDAgaWYgY29sbGF0ZXJhbF9yYXcgPiAxMDAwIGVsc2UgX2YoImNvbGxhdGVyYWwiKQoKICAgICMgUG5MOiB1c2UgcG5sQWZ0ZXJGZWVzVXNkIChtaWNyby11bml0cykgb3IgcG5sQWZ0ZXJGZWVzCiAgICBwbmxfcmF3ID0gX2YoInBubEFmdGVyRmVlc1VzZCIpCiAgICBwbmwgPSBwbmxfcmF3IGlmIGFicyhwbmxfcmF3KSA8IDFfMDAwXzAwMCBlbHNlIHBubF9yYXcgLyAxXzAwMF8wMDAKCiAgICAjIEZ1bmRpbmcgcmF0ZTogZGVyaXZlIGZyb20gYm9ycm93IGZlZXMgLyBwb3NpdGlvbiBhZ2UgaW4gZGF5cwogICAgYm9ycm93X2ZlZXNfdXNkID0gX2YoImJvcnJvd0ZlZXNVc2QiKQogICAgY3JlYXRlZF90aW1lID0gX2YoImNyZWF0ZWRUaW1lIikKICAgIGZ1bmRpbmdfcmF0ZSA9IDAuMAogICAgaWYgYm9ycm93X2ZlZXNfdXNkIGFuZCBjcmVhdGVkX3RpbWUgYW5kIHNpemVfdXNkID4gMDoKICAgICAgICBpbXBvcnQgdGltZSBhcyBfdGltZQogICAgICAgIGRheXNfb3BlbiA9IG1heCgxLCAoX3RpbWUudGltZSgpIC0gY3JlYXRlZF90aW1lKSAvIDg2NDAwKQogICAgICAgICMgRGFpbHkgcmF0ZSBhcyAlIG9mIHBvc2l0aW9uIHNpemUKICAgICAgICBmdW5kaW5nX3JhdGUgPSAoYm9ycm93X2ZlZXNfdXNkIC8gZGF5c19vcGVuKSAvIHNpemVfdXNkICogMTAwCgogICAgIyBGYWxsYmFjayBsZXZlcmFnZSBjYWxjCiAgICBpZiBsZXZlcmFnZSA9PSAwIGFuZCBjb2xsYXRlcmFsID4gMCBhbmQgc2l6ZV91c2QgPiAwOgogICAgICAgIGxldmVyYWdlID0gc2l6ZV91c2QgLyBjb2xsYXRlcmFsCgogICAgc2lkZSA9IHN0cihwb3MuZ2V0KCJzaWRlIikgb3IgImxvbmciKS51cHBlcigpCgogICAgcmV0dXJuIHsKICAgICAgICAiZW50cnlfcHJpY2UiOiAgZW50cnlfcHJpY2UsCiAgICAgICAgIm1hcmtfcHJpY2UiOiAgIG1hcmtfcHJpY2UsCiAgICAgICAgInNpemVfdXNkIjogICAgIHNpemVfdXNkLAogICAgICAgICJjb2xsYXRlcmFsIjogICBjb2xsYXRlcmFsLAogICAgICAgICJsaXFfcHJpY2UiOiAgICBsaXFfcHJpY2UsCiAgICAgICAgInBubCI6ICAgICAgICAgIHBubCwKICAgICAgICAiZnVuZGluZ19yYXRlIjogZnVuZGluZ19yYXRlLAogICAgICAgICJsZXZlcmFnZSI6ICAgICBsZXZlcmFnZSwKICAgICAgICAibWFya2V0IjogICAgICAgIlNPTC1QRVJQIiwKICAgICAgICAic2lkZSI6ICAgICAgICAgc2lkZSwKICAgICAgICAiYm9ycm93X2ZlZXNfdXNkIjogYm9ycm93X2ZlZXNfdXNkLAogICAgICAgICJyYXciOiAgICAgICAgICBwb3MsCiAgICB9CgoKIyDilIDilIAgRmFsbGJhY2s6IGZldGNoIFNPTCBwcmljZSBmcm9tIERleFNjcmVlbmVyIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIGZldGNoX3NvbF9wcmljZSgpOgogICAgIiIiRmV0Y2ggY3VycmVudCBTT0wgcHJpY2UgZnJvbSBEZXhTY3JlZW5lciBhcyBmYWxsYmFjayBtYXJrIHByaWNlLiIiIgogICAgdHJ5OgogICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgICJodHRwczovL2FwaS5kZXhzY3JlZW5lci5jb20vbGF0ZXN0L2RleC9zZWFyY2giLAogICAgICAgICAgICBwYXJhbXM9eyJxIjogIlNPTCJ9LAogICAgICAgICAgICB0aW1lb3V0PTEwLAogICAgICAgICkKICAgICAgICBkYXRhID0gci5qc29uKCkgb3Ige30KICAgICAgICBwYWlycyA9IGRhdGEuZ2V0KCJwYWlycyIpIG9yIFtdCiAgICAgICAgc29sX3N0YWJsZSA9IFsKICAgICAgICAgICAgcCBmb3IgcCBpbiBwYWlycwogICAgICAgICAgICBpZiBwLmdldCgiY2hhaW5JZCIpID09ICJzb2xhbmEiCiAgICAgICAgICAgIGFuZCBzdHIocC5nZXQoImJhc2VUb2tlbiIsIHt9KS5nZXQoInN5bWJvbCIpIG9yICIiKS51cHBlcigpID09ICJTT0wiCiAgICAgICAgICAgIGFuZCBzdHIocC5nZXQoInF1b3RlVG9rZW4iLCB7fSkuZ2V0KCJzeW1ib2wiKSBvciAiIikudXBwZXIoKSBpbiAoIlVTREMiLCAiVVNEVCIpCiAgICAgICAgXQogICAgICAgIGlmIHNvbF9zdGFibGU6CiAgICAgICAgICAgIGJlc3QgPSBzb3J0ZWQoc29sX3N0YWJsZSwga2V5PWxhbWJkYSBwOiBmbG9hdCgocC5nZXQoImxpcXVpZGl0eSIpIG9yIHt9KS5nZXQoInVzZCIpIG9yIDApLCByZXZlcnNlPVRydWUpWzBdCiAgICAgICAgICAgIHJldHVybiBmbG9hdChiZXN0LmdldCgicHJpY2VVc2QiKSBvciAwKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzCiAgICByZXR1cm4gTm9uZQoKCiMg4pSA4pSAIENhbGN1bGF0aW9ucyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBjYWxjX2xpcV9kaXN0YW5jZV9wY3QobWFya19wcmljZSwgbGlxX3ByaWNlKToKICAgICIiIlJldHVybnMgJSBkaXN0YW5jZSBmcm9tIG1hcmsgdG8gbGlxdWlkYXRpb24gKHBvc2l0aXZlID0gc2FmZSkuIiIiCiAgICBpZiBub3QgbWFya19wcmljZSBvciBub3QgbGlxX3ByaWNlIG9yIGxpcV9wcmljZSA8PSAwOgogICAgICAgIHJldHVybiBOb25lCiAgICByZXR1cm4gYWJzKG1hcmtfcHJpY2UgLSBsaXFfcHJpY2UpIC8gbWFya19wcmljZSAqIDEwMAoKCmRlZiBjYWxjX3doYXRfaWYocG9zaXRpb24sIHRhcmdldF9wcmljZSk6CiAgICAiIiJDYWxjdWxhdGUgUG5MIGFuZCBuZXcgcG9zaXRpb24gc3RhdGUgYXQgYSB0YXJnZXQgcHJpY2UuIiIiCiAgICBpZiBub3QgcG9zaXRpb246CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIGVudHJ5ID0gcG9zaXRpb25bImVudHJ5X3ByaWNlIl0KICAgIHNpemUgPSBwb3NpdGlvblsic2l6ZV91c2QiXQogICAgY29sbGF0ZXJhbCA9IHBvc2l0aW9uWyJjb2xsYXRlcmFsIl0KICAgIGxpcSA9IHBvc2l0aW9uWyJsaXFfcHJpY2UiXQogICAgaWYgbm90IGVudHJ5IG9yIGVudHJ5IDw9IDAgb3Igbm90IHNpemUgb3Igbm90IGNvbGxhdGVyYWw6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHByaWNlX2NoYW5nZV9wY3QgPSAodGFyZ2V0X3ByaWNlIC0gZW50cnkpIC8gZW50cnkgKiAxMDAKICAgIHBubCA9IHNpemUgKiAocHJpY2VfY2hhbmdlX3BjdCAvIDEwMCkKICAgIG5ld19jb2xsYXRlcmFsID0gY29sbGF0ZXJhbCArIHBubAogICAgbGlxX2Rpc3RhbmNlID0gY2FsY19saXFfZGlzdGFuY2VfcGN0KHRhcmdldF9wcmljZSwgbGlxKQogICAgcmV0dXJuIHsKICAgICAgICAidGFyZ2V0X3ByaWNlIjogdGFyZ2V0X3ByaWNlLAogICAgICAgICJwcmljZV9jaGFuZ2VfcGN0IjogcHJpY2VfY2hhbmdlX3BjdCwKICAgICAgICAicG5sIjogcG5sLAogICAgICAgICJuZXdfY29sbGF0ZXJhbCI6IG5ld19jb2xsYXRlcmFsLAogICAgICAgICJsaXFfZGlzdGFuY2VfcGN0IjogbGlxX2Rpc3RhbmNlLAogICAgfQoKCmRlZiBjYWxjX21vbnRobHlfYWRkX2ltcGFjdChwb3NpdGlvbiwgYWRkX3VzZD1NT05USExZX0FERF9VU0QsIGxldmVyYWdlPU1PTlRITFlfTEVWRVJBR0UpOgogICAgIiIiQ2FsY3VsYXRlIHdoYXQgYWRkaW5nICQyNTAgYXQgM3ggbGV2ZXJhZ2UgZG9lcyB0byBwb3NpdGlvbi4iIiIKICAgIGlmIG5vdCBwb3NpdGlvbjoKICAgICAgICByZXR1cm4gTm9uZQogICAgbmV3X3NpemUgPSBhZGRfdXNkICogbGV2ZXJhZ2UKICAgIGN1cnJlbnRfc2l6ZSA9IHBvc2l0aW9uWyJzaXplX3VzZCJdCiAgICBjdXJyZW50X2NvbGxhdGVyYWwgPSBwb3NpdGlvblsiY29sbGF0ZXJhbCJdCiAgICBuZXdfdG90YWxfc2l6ZSA9IGN1cnJlbnRfc2l6ZSArIG5ld19zaXplCiAgICBuZXdfdG90YWxfY29sbGF0ZXJhbCA9IGN1cnJlbnRfY29sbGF0ZXJhbCArIGFkZF91c2QKICAgIG5ld19sZXZlcmFnZSA9IG5ld190b3RhbF9zaXplIC8gbmV3X3RvdGFsX2NvbGxhdGVyYWwgaWYgbmV3X3RvdGFsX2NvbGxhdGVyYWwgPiAwIGVsc2UgMAogICAgcmV0dXJuIHsKICAgICAgICAiYWRkX3VzZCI6IGFkZF91c2QsCiAgICAgICAgImFkZF9sZXZlcmFnZSI6IGxldmVyYWdlLAogICAgICAgICJuZXdfc2l6ZV9hZGRlZCI6IG5ld19zaXplLAogICAgICAgICJuZXdfdG90YWxfc2l6ZSI6IG5ld190b3RhbF9zaXplLAogICAgICAgICJuZXdfdG90YWxfY29sbGF0ZXJhbCI6IG5ld190b3RhbF9jb2xsYXRlcmFsLAogICAgICAgICJuZXdfbGV2ZXJhZ2UiOiBuZXdfbGV2ZXJhZ2UsCiAgICB9CgoKIyDilIDilIAgU09MIFZvbGF0aWxpdHkgKDMwZCkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACgpfdm9sX2NhY2hlID0geyJ2YWx1ZSI6IE5vbmUsICJ0cyI6IDAuMH0KX1ZPTF9DQUNIRV9UVEwgPSAzNjAwICAjIHJlZnJlc2ggaG91cmx5CgoKZGVmIGZldGNoX3NvbF92b2xhdGlsaXR5XzMwZCgpOgogICAgIiIiCiAgICBFc3RpbWF0ZSAzMC1kYXkgU09MIHZvbGF0aWxpdHkgdXNpbmcgQ29pbkdlY2tvIGRhaWx5IE9ITEMuCiAgICBSZXR1cm5zIGFubnVhbGlzZWQgZGFpbHkgdm9sICUgKGUuZy4gOC4zIG1lYW5zIDguMyUpLgogICAgQ2FjaGVzIHJlc3VsdCBmb3IgMSBob3VyLgogICAgIiIiCiAgICBub3cgPSB0aW1lLnRpbWUoKQogICAgaWYgX3ZvbF9jYWNoZVsidmFsdWUiXSBpcyBub3QgTm9uZSBhbmQgbm93IC0gX3ZvbF9jYWNoZVsidHMiXSA8IF9WT0xfQ0FDSEVfVFRMOgogICAgICAgIHJldHVybiBfdm9sX2NhY2hlWyJ2YWx1ZSJdCiAgICB0cnk6CiAgICAgICAgIyBDb2luR2Vja28gZnJlZSBlbmRwb2ludCDigJQgbm8ga2V5IG5lZWRlZAogICAgICAgIHVybCA9ICJodHRwczovL2FwaS5jb2luZ2Vja28uY29tL2FwaS92My9jb2lucy9zb2xhbmEvbWFya2V0X2NoYXJ0IgogICAgICAgIHBhcmFtcyA9IHsidnNfY3VycmVuY3kiOiAidXNkIiwgImRheXMiOiAiMzAiLCAiaW50ZXJ2YWwiOiAiZGFpbHkifQogICAgICAgIHIgPSByZXF1ZXN0cy5nZXQodXJsLCBwYXJhbXM9cGFyYW1zLCB0aW1lb3V0PTEyKQogICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGRhdGEgPSByLmpzb24oKSBvciB7fQogICAgICAgIHByaWNlcyA9IFtwWzFdIGZvciBwIGluIChkYXRhLmdldCgicHJpY2VzIikgb3IgW10pIGlmIHAgYW5kIGxlbihwKSA+IDFdCiAgICAgICAgaWYgbGVuKHByaWNlcykgPCA1OgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICMgRGFpbHkgbG9nIHJldHVybnMKICAgICAgICByZXR1cm5zID0gW21hdGgubG9nKHByaWNlc1tpXSAvIHByaWNlc1tpIC0gMV0pIGZvciBpIGluIHJhbmdlKDEsIGxlbihwcmljZXMpKV0KICAgICAgICBtZWFuID0gc3VtKHJldHVybnMpIC8gbGVuKHJldHVybnMpCiAgICAgICAgdmFyaWFuY2UgPSBzdW0oKHIgLSBtZWFuKSAqKiAyIGZvciByIGluIHJldHVybnMpIC8gbGVuKHJldHVybnMpCiAgICAgICAgZGFpbHlfdm9sID0gbWF0aC5zcXJ0KHZhcmlhbmNlKSAqIDEwMCAgIyBhcyAlCiAgICAgICAgX3ZvbF9jYWNoZVsidmFsdWUiXSA9IGRhaWx5X3ZvbAogICAgICAgIF92b2xfY2FjaGVbInRzIl0gPSBub3cKICAgICAgICByZXR1cm4gZGFpbHlfdm9sCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2luZy53YXJuaW5nKCJzb2xfdm9sYXRpbGl0eSBmZXRjaCBlcnJvcjogJXMiLCBlKQogICAgICAgIHJldHVybiBOb25lCgoKIyDilIDilIAgTGlxdWlkYXRpb24gcHJpY2UgZXN0aW1hdGlvbiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBlc3RpbWF0ZV9saXFfcHJpY2UoZW50cnlfcHJpY2UsIGNvbGxhdGVyYWwsIHNpemVfdXNkLCBzaWRlPSJMT05HIiwgbWFpbnRlbmFuY2VfbWFyZ2luPTAuMDEpOgogICAgIiIiCiAgICBFc3RpbWF0ZSBsaXF1aWRhdGlvbiBwcmljZSBmb3IgYSBsZXZlcmFnZWQgcG9zaXRpb24uCiAgICBVc2VzIHNpbXBsaWZpZWQgZm9ybXVsYTogbGlxID0gZW50cnkgKiAoMSAtIChjb2xsYXRlcmFsL3NpemUpICsgbWFpbnRlbmFuY2VfbWFyZ2luKQogICAgRm9yIExPTkc6IGxpcSA9IGVudHJ5ICogKDEgLSAoY29sbGF0ZXJhbCAtIG1haW50ZW5hbmNlKnNpemUpIC8gc2l6ZSkKICAgICIiIgogICAgaWYgbm90IGVudHJ5X3ByaWNlIG9yIG5vdCBjb2xsYXRlcmFsIG9yIG5vdCBzaXplX3VzZCBvciBzaXplX3VzZCA8PSAwOgogICAgICAgIHJldHVybiBOb25lCiAgICB0cnk6CiAgICAgICAgIyBjb2xsYXRlcmFsIHJhdGlvCiAgICAgICAgY29sX3JhdGlvID0gY29sbGF0ZXJhbCAvIHNpemVfdXNkCiAgICAgICAgaWYgc2lkZSA9PSAiTE9ORyI6CiAgICAgICAgICAgIGxpcSA9IGVudHJ5X3ByaWNlICogKDEgLSBjb2xfcmF0aW8gKyBtYWludGVuYW5jZV9tYXJnaW4pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbGlxID0gZW50cnlfcHJpY2UgKiAoMSArIGNvbF9yYXRpbyAtIG1haW50ZW5hbmNlX21hcmdpbikKICAgICAgICByZXR1cm4gbWF4KDAuMCwgbGlxKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gTm9uZQoKCiMg4pSA4pSAIExldmVyYWdlIFJlY29tbWVuZGF0aW9uIEVuZ2luZSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKCmRlZiBjYWxjX2xldmVyYWdlX3JlY29tbWVuZGF0aW9uKHBvc2l0aW9uLCBzb2xfcHJpY2UsIGFkZF91c2Q9TU9OVEhMWV9BRERfVVNELCB2b2w9Tm9uZSwgZnVuZGluZz1Ob25lKToKICAgICIiIgogICAgRm9yIGEgZ2l2ZW4gJGFkZF91c2QsIGNhbGN1bGF0ZSBTQUZFIC8gTkVVVFJBTCAvIEFHR1JFU1NJVkUgbGV2ZXJhZ2Ugb3B0aW9ucy4KICAgIFJldHVybnMgZGljdCB3aXRoIHJlY29tbWVuZGF0aW9ucyBhbmQgY29udGV4dC4KICAgICIiIgogICAgaWYgbm90IHNvbF9wcmljZSBvciBzb2xfcHJpY2UgPD0gMDoKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGN1cnJlbnRfc2l6ZSA9IGZsb2F0KChwb3NpdGlvbiBvciB7fSkuZ2V0KCJzaXplX3VzZCIpIG9yIDApCiAgICBjdXJyZW50X2NvbGxhdGVyYWwgPSBmbG9hdCgocG9zaXRpb24gb3Ige30pLmdldCgiY29sbGF0ZXJhbCIpIG9yIDApCiAgICBjdXJyZW50X2xpcSA9IGZsb2F0KChwb3NpdGlvbiBvciB7fSkuZ2V0KCJsaXFfcHJpY2UiKSBvciAwKQogICAgZW50cnlfcHJpY2UgPSBmbG9hdCgocG9zaXRpb24gb3Ige30pLmdldCgiZW50cnlfcHJpY2UiKSBvciBzb2xfcHJpY2UpCiAgICBmdW5kaW5nID0gZnVuZGluZyBvciBmbG9hdCgocG9zaXRpb24gb3Ige30pLmdldCgiZnVuZGluZ19yYXRlIikgb3IgMCkKCiAgICB2b2wgPSB2b2wgICMgbWF5IGJlIE5vbmUKCiAgICAjIFZvbGF0aWxpdHkgYWRqdXN0bWVudDogaWYgdm9sID4gMTAlLCBudWRnZSBsZXZlcmFnZSBkb3duIGJ5IDAuNXgKICAgIHZvbF9hZGp1c3RtZW50ID0gMC4wCiAgICBpZiB2b2wgYW5kIHZvbCA+IFZPTF9ISUdIX1RIUkVTSE9MRDoKICAgICAgICB2b2xfYWRqdXN0bWVudCA9IC0wLjUKCiAgICBsZXZlcmFnZV9vcHRpb25zID0gWwogICAgICAgICgic2FmZSIsICAgICAgICLwn5+iIFNBRkUgWk9ORSIsICAgICAgIFNBRkVfTEVWRVJBR0UgICAgICAgKyB2b2xfYWRqdXN0bWVudCwgIlNsZWVwIHdlbGwgYXQgbmlnaHQiLCAgICAgICAgICJWZXJ5IGxvdywgc2xvdyBjb21wb3VuZGluZyIpLAogICAgICAgICgibmV1dHJhbCIsICAgICLwn5+hIE5FVVRSQUwgWk9ORSIsICAgICBORVVUUkFMX0xFVkVSQUdFICAgICsgdm9sX2FkanVzdG1lbnQsICJTdGFuZGFyZCBEQ0Egc3RyYXRlZ3kiLCAgICAgICAiTW9kZXJhdGUsIGJhbGFuY2VkIHJldHVybnMiKSwKICAgICAgICAoImFnZ3Jlc3NpdmUiLCAi8J+UtCBBR0dSRVNTSVZFIFpPTkUiLCAgQUdHUkVTU0lWRV9MRVZFUkFHRSArIHZvbF9hZGp1c3RtZW50LCAiT25seSBpZiBhY3RpdmVseSBtb25pdG9yaW5nIiwgIkhpZ2hlciwgZmFzdGVyIGxpcXVpZGF0aW9uIiksCiAgICBdCgogICAgIyBDYXAgZWFjaCBhdCBNQVhfTEVWRVJBR0UgYW5kIGZsb29yIGF0IDEuMAogICAgbGV2ZXJhZ2Vfb3B0aW9ucyA9IFsKICAgICAgICAoaywgbGFiZWwsIG1heCgxLjAsIG1pbihNQVhfTEVWRVJBR0UsIGxldikpLCBkZXNjLCByaXNrKQogICAgICAgIGZvciBrLCBsYWJlbCwgbGV2LCBkZXNjLCByaXNrIGluIGxldmVyYWdlX29wdGlvbnMKICAgIF0KCiAgICByZXN1bHRzID0gW10KICAgIGZvciBrZXksIGxhYmVsLCBsZXYsIGJlc3RfZm9yLCByaXNrIGluIGxldmVyYWdlX29wdGlvbnM6CiAgICAgICAgbmV3X3NpemVfYWRkZWQgPSBhZGRfdXNkICogbGV2CiAgICAgICAgbmV3X3RvdGFsX3NpemUgPSBjdXJyZW50X3NpemUgKyBuZXdfc2l6ZV9hZGRlZAogICAgICAgIG5ld190b3RhbF9jb2xsYXRlcmFsID0gY3VycmVudF9jb2xsYXRlcmFsICsgYWRkX3VzZAogICAgICAgIG5ld19lZmZlY3RpdmVfbGV2ZXJhZ2UgPSBuZXdfdG90YWxfc2l6ZSAvIG5ld190b3RhbF9jb2xsYXRlcmFsIGlmIG5ld190b3RhbF9jb2xsYXRlcmFsID4gMCBlbHNlIGxldgoKICAgICAgICAjIEVzdGltYXRlIG5ldyBsaXEgcHJpY2UgZm9yIHRoZSBjb21iaW5lZCBwb3NpdGlvbgogICAgICAgIG5ld19saXEgPSBlc3RpbWF0ZV9saXFfcHJpY2UoZW50cnlfcHJpY2UsIG5ld190b3RhbF9jb2xsYXRlcmFsLCBuZXdfdG90YWxfc2l6ZSkKICAgICAgICBsaXFfZGlzdCA9IGNhbGNfbGlxX2Rpc3RhbmNlX3BjdChzb2xfcHJpY2UsIG5ld19saXEpCgogICAgICAgICMgRnVuZGluZyBjb3N0IGVzdGltYXRlIChkYWlseSwgZm9yIGRpc3BsYXkpCiAgICAgICAgZGFpbHlfZnVuZGluZ19jb3N0ID0gbmV3X3RvdGFsX3NpemUgKiBhYnMoZnVuZGluZykgLyAxMDAgaWYgZnVuZGluZyBlbHNlIDAKCiAgICAgICAgIyBCbG9ja2VkIGlmIHdvdWxkIGJlIDwgZGFuZ2VyIHRocmVzaG9sZAogICAgICAgIGJsb2NrZWQgPSBsaXFfZGlzdCBpcyBub3QgTm9uZSBhbmQgbGlxX2Rpc3QgPCBEQU5HRVJfTElRX0RJU1RBTkNFCgogICAgICAgICMgWm9uZSBjbGFzc2lmaWNhdGlvbgogICAgICAgIGlmIGxpcV9kaXN0IGlzIE5vbmU6CiAgICAgICAgICAgIHpvbmUgPSAidW5rbm93biIKICAgICAgICBlbGlmIGxpcV9kaXN0ID49IFNBRkVfTElRX0RJU1RBTkNFOgogICAgICAgICAgICB6b25lID0gInNhZmUiCiAgICAgICAgZWxpZiBsaXFfZGlzdCA+PSBORVVUUkFMX0xJUV9ESVNUQU5DRToKICAgICAgICAgICAgem9uZSA9ICJuZXV0cmFsIgogICAgICAgIGVsaWYgbGlxX2Rpc3QgPj0gV0FSTl9MSVFfRElTVEFOQ0U6CiAgICAgICAgICAgIHpvbmUgPSAiYWdncmVzc2l2ZSIKICAgICAgICBlbHNlOgogICAgICAgICAgICB6b25lID0gImRhbmdlciIKCiAgICAgICAgcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAia2V5Ijoga2V5LAogICAgICAgICAgICAibGFiZWwiOiBsYWJlbCwKICAgICAgICAgICAgImxldmVyYWdlIjogbGV2LAogICAgICAgICAgICAiZWZmZWN0aXZlX2xldmVyYWdlIjogbmV3X2VmZmVjdGl2ZV9sZXZlcmFnZSwKICAgICAgICAgICAgIm5ld19zaXplX2FkZGVkIjogbmV3X3NpemVfYWRkZWQsCiAgICAgICAgICAgICJuZXdfdG90YWxfc2l6ZSI6IG5ld190b3RhbF9zaXplLAogICAgICAgICAgICAibmV3X3RvdGFsX2NvbGxhdGVyYWwiOiBuZXdfdG90YWxfY29sbGF0ZXJhbCwKICAgICAgICAgICAgIm5ld19saXFfcHJpY2UiOiBuZXdfbGlxLAogICAgICAgICAgICAibGlxX2Rpc3RhbmNlX3BjdCI6IGxpcV9kaXN0LAogICAgICAgICAgICAiem9uZSI6IHpvbmUsCiAgICAgICAgICAgICJibG9ja2VkIjogYmxvY2tlZCwKICAgICAgICAgICAgImRhaWx5X2Z1bmRpbmdfY29zdCI6IGRhaWx5X2Z1bmRpbmdfY29zdCwKICAgICAgICAgICAgImJlc3RfZm9yIjogYmVzdF9mb3IsCiAgICAgICAgICAgICJyaXNrIjogcmlzaywKICAgICAgICB9KQoKICAgICMgV29yc3QtY2FzZTogU09MIGRyb3BzIDIwJQogICAgd29yc3RfY2FzZV9wcmljZSA9IHNvbF9wcmljZSAqIDAuODAKICAgIHdvcnN0X2xpcV9kaXN0ID0gY2FsY19saXFfZGlzdGFuY2VfcGN0KHdvcnN0X2Nhc2VfcHJpY2UsIGN1cnJlbnRfbGlxKSBpZiBjdXJyZW50X2xpcSBlbHNlIE5vbmUKCiAgICAjIFJlY29tbWVuZGVkID0gZmlyc3Qgbm9uLWJsb2NrZWQgb3B0aW9uIG1hdGNoaW5nIHJpc2sgdG9sZXJhbmNlCiAgICByZWNvbW1lbmRlZCA9IG5leHQoKHIgZm9yIHIgaW4gcmVzdWx0cyBpZiBub3QgclsiYmxvY2tlZCJdKSwgTm9uZSkKCiAgICByZXR1cm4gewogICAgICAgICJyZXN1bHRzIjogcmVzdWx0cywKICAgICAgICAicmVjb21tZW5kZWQiOiByZWNvbW1lbmRlZCwKICAgICAgICAiYWRkX3VzZCI6IGFkZF91c2QsCiAgICAgICAgInNvbF9wcmljZSI6IHNvbF9wcmljZSwKICAgICAgICAidm9sIjogdm9sLAogICAgICAgICJmdW5kaW5nIjogZnVuZGluZywKICAgICAgICAidm9sX2FkanVzdG1lbnQiOiB2b2xfYWRqdXN0bWVudCwKICAgICAgICAid29yc3RfY2FzZV9wcmljZSI6IHdvcnN0X2Nhc2VfcHJpY2UsCiAgICAgICAgIndvcnN0X2Nhc2VfbGlxX2Rpc3QiOiB3b3JzdF9saXFfZGlzdCwKICAgICAgICAiY3VycmVudF9wb3NpdGlvbiI6IHBvc2l0aW9uLAogICAgfQoKCmRlZiBjYWxjX3ByaWNlX3pvbmVzKHBvc2l0aW9uLCBzb2xfcHJpY2UsIHpvbmVfcHJpY2VzPU5vbmUpOgogICAgIiIiCiAgICBGb3IgZWFjaCBwcmljZSBsZXZlbCwgc2hvdyBQbkwsIGxpcSBkaXN0YW5jZSwgYW5kIGFjdGlvbi4KICAgIEFsc28gc2hvd3MgbGlxIHByaWNlIGF0IHNhZmUvbmV1dHJhbC9hZ2dyZXNzaXZlIGxldmVyYWdlLgogICAgIiIiCiAgICBpZiBub3QgcG9zaXRpb246CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHpvbmVfcHJpY2VzID0gem9uZV9wcmljZXMgb3IgUFJJQ0VfWk9ORV9MRVZFTFMKICAgIGVudHJ5ID0gZmxvYXQocG9zaXRpb24uZ2V0KCJlbnRyeV9wcmljZSIpIG9yIHNvbF9wcmljZSkKICAgIHNpemUgPSBmbG9hdChwb3NpdGlvbi5nZXQoInNpemVfdXNkIikgb3IgMCkKICAgIGNvbGxhdGVyYWwgPSBmbG9hdChwb3NpdGlvbi5nZXQoImNvbGxhdGVyYWwiKSBvciAwKQogICAgbGlxID0gZmxvYXQocG9zaXRpb24uZ2V0KCJsaXFfcHJpY2UiKSBvciAwKQoKICAgIHpvbmVzID0gW10KICAgIGZvciBwcmljZSBpbiBzb3J0ZWQoem9uZV9wcmljZXMsIHJldmVyc2U9VHJ1ZSk6CiAgICAgICAgcHJpY2VfY2hnX3BjdCA9IChwcmljZSAtIGVudHJ5KSAvIGVudHJ5ICogMTAwIGlmIGVudHJ5ID4gMCBlbHNlIDAKICAgICAgICBwbmwgPSBzaXplICogKHByaWNlX2NoZ19wY3QgLyAxMDApCiAgICAgICAgbGlxX2Rpc3QgPSBjYWxjX2xpcV9kaXN0YW5jZV9wY3QocHJpY2UsIGxpcSkKCiAgICAgICAgaWYgbGlxX2Rpc3QgaXMgTm9uZToKICAgICAgICAgICAgc3RhdHVzID0gIuKdkyBVTktOT1dOIgogICAgICAgICAgICBhY3Rpb24gPSAiQ2hlY2sgcG9zaXRpb24gZGF0YSIKICAgICAgICBlbGlmIHByaWNlIDw9IGxpcToKICAgICAgICAgICAgc3RhdHVzID0gIuKdjCBMSVFVSURBVEVEIgogICAgICAgICAgICBhY3Rpb24gPSAiUG9zaXRpb24gY2xvc2VkIgogICAgICAgIGVsaWYgbGlxX2Rpc3QgPCBXQVJOX0xJUV9ESVNUQU5DRToKICAgICAgICAgICAgc3RhdHVzID0gIvCflLQgV0FSTklORyIKICAgICAgICAgICAgYWN0aW9uID0gIlRvcC11cCBjb2xsYXRlcmFsIE5PVyBvciBjbG9zZSIKICAgICAgICBlbGlmIGxpcV9kaXN0IDwgTkVVVFJBTF9MSVFfRElTVEFOQ0U6CiAgICAgICAgICAgIHN0YXR1cyA9ICLwn5+hIENBVVRJT04iCiAgICAgICAgICAgIGFjdGlvbiA9ICJDb25zaWRlciBhZGRpbmcgY29sbGF0ZXJhbCIKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdGF0dXMgPSAi4pyFIFNBRkUiCiAgICAgICAgICAgIGFjdGlvbiA9ICJIb2xkIG9yIHRyaW0iCgogICAgICAgIHpvbmVzLmFwcGVuZCh7CiAgICAgICAgICAgICJwcmljZSI6IHByaWNlLAogICAgICAgICAgICAicG5sIjogcG5sLAogICAgICAgICAgICAibGlxX2Rpc3QiOiBsaXFfZGlzdCwKICAgICAgICAgICAgInN0YXR1cyI6IHN0YXR1cywKICAgICAgICAgICAgImFjdGlvbiI6IGFjdGlvbiwKICAgICAgICB9KQoKICAgICMgU2FmZSBwcmljZSBmbG9vcnMgYXQgZGlmZmVyZW50IGxldmVyYWdlcyAoZm9yIGN1cnJlbnQgYWRkIGFtb3VudCkKICAgIGRlZiBmbG9vcl9hdF9sZXYobGV2KToKICAgICAgICBzeiA9IHNpemUgKyBNT05USExZX0FERF9VU0QgKiBsZXYKICAgICAgICBjb2wgPSBjb2xsYXRlcmFsICsgTU9OVEhMWV9BRERfVVNECiAgICAgICAgcmV0dXJuIGVzdGltYXRlX2xpcV9wcmljZShlbnRyeSwgY29sLCBzeikKCiAgICBmbG9vcnMgPSB7CiAgICAgICAgZiJ7U0FGRV9MRVZFUkFHRTouMWZ9eCI6IGZsb29yX2F0X2xldihTQUZFX0xFVkVSQUdFKSwKICAgICAgICBmIntORVVUUkFMX0xFVkVSQUdFOi4xZn14IjogZmxvb3JfYXRfbGV2KE5FVVRSQUxfTEVWRVJBR0UpLAogICAgICAgIGYie0FHR1JFU1NJVkVfTEVWRVJBR0U6LjFmfXgiOiBmbG9vcl9hdF9sZXYoQUdHUkVTU0lWRV9MRVZFUkFHRSksCiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgICAiem9uZXMiOiB6b25lcywKICAgICAgICAiZmxvb3JzIjogZmxvb3JzLAogICAgICAgICJjdXJyZW50X2xpcSI6IGxpcSwKICAgICAgICAiZW50cnkiOiBlbnRyeSwKICAgICAgICAibGV2ZXJhZ2UiOiBmbG9hdChwb3NpdGlvbi5nZXQoImxldmVyYWdlIikgb3IgMCksCiAgICAgICAgInNvbF9wcmljZSI6IHNvbF9wcmljZSwKICAgIH0KCgojIOKUgOKUgCBGb3JtYXR0ZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIF9mcCh2LCBkZWNpbWFscz0yKToKICAgICIiIkZvcm1hdCBwcmljZS4iIiIKICAgIGlmIHYgaXMgTm9uZToKICAgICAgICByZXR1cm4gIk4vQSIKICAgIHRyeToKICAgICAgICByZXR1cm4gZiIke2Zsb2F0KHYpOiwue2RlY2ltYWxzfWZ9IgogICAgZXhjZXB0IChUeXBlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHJldHVybiAiTi9BIgoKCmRlZiBfZnYodiwgZGVjaW1hbHM9Mik6CiAgICAiIiJGb3JtYXQgVVNEIHZhbHVlIGNvbXBhY3QuIiIiCiAgICBpZiB2IGlzIE5vbmU6CiAgICAgICAgcmV0dXJuICJOL0EiCiAgICB0cnk6CiAgICAgICAgdiA9IGZsb2F0KHYpCiAgICAgICAgaWYgYWJzKHYpID49IDFfMDAwXzAwMDoKICAgICAgICAgICAgcmV0dXJuIGYiJHt2LzFfMDAwXzAwMDouMmZ9TSIKICAgICAgICBpZiBhYnModikgPj0gMV8wMDA6CiAgICAgICAgICAgIHJldHVybiBmIiR7di8xXzAwMDouMWZ9SyIKICAgICAgICByZXR1cm4gZiIke3Y6LC57ZGVjaW1hbHN9Zn0iCiAgICBleGNlcHQgKFR5cGVFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgcmV0dXJuICJOL0EiCgoKZGVmIF9mcGN0KHYsIGRlY2ltYWxzPTIpOgogICAgIiIiRm9ybWF0IHBlcmNlbnRhZ2UuIiIiCiAgICBpZiB2IGlzIE5vbmU6CiAgICAgICAgcmV0dXJuICJOL0EiCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGYie2Zsb2F0KHYpOisue2RlY2ltYWxzfWZ9JSIKICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBWYWx1ZUVycm9yKToKICAgICAgICByZXR1cm4gIk4vQSIKCgpkZWYgZm9ybWF0X2xldl9kYXNoYm9hcmQocG9zaXRpb24sIHNvbF9wcmljZT1Ob25lKToKICAgICIiIkZvcm1hdCAvbGV2IGRhc2hib2FyZCBtZXNzYWdlLiIiIgogICAgbm93ID0gZGF0ZXRpbWUubm93KHRpbWV6b25lLnV0Yykuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNIFVUQyIpCgogICAgaWYgbm90IHBvc2l0aW9uOgogICAgICAgICMgTm8gcG9zaXRpb24gZm91bmQg4oCUIHNob3cgU09MIHByaWNlIG9ubHkKICAgICAgICBwcmljZV9saW5lID0gX2ZwKHNvbF9wcmljZSkgaWYgc29sX3ByaWNlIGVsc2UgIk4vQSIKICAgICAgICByZXR1cm4gIlxuIi5qb2luKFsKICAgICAgICAgICAgZiI8Yj7wn5OKIFtMRVZdOiBTT0wgUE9TSVRJT048L2I+IiwKICAgICAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPuKdjCBOTyBPUEVOIFBPU0lUSU9OIEZPVU5EPC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+SsCBTT0wgUFJJQ0U6IHtwcmljZV9saW5lfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCflZAgQ0hFQ0tFRDoge25vd308L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfkqEgT3BlbiBhIHBvc2l0aW9uIG9uIEp1cGl0ZXIgUGVycHM8L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT4gICB0byBzdGFydCB0cmFja2luZy48L2NvZGU+IiwKICAgICAgICBdKQoKICAgIG1hcmsgPSBwb3NpdGlvblsibWFya19wcmljZSJdIG9yIHNvbF9wcmljZQogICAgZW50cnkgPSBwb3NpdGlvblsiZW50cnlfcHJpY2UiXQogICAgc2l6ZSA9IHBvc2l0aW9uWyJzaXplX3VzZCJdCiAgICBjb2xsYXRlcmFsID0gcG9zaXRpb25bImNvbGxhdGVyYWwiXQogICAgbGlxID0gcG9zaXRpb25bImxpcV9wcmljZSJdCiAgICBwbmwgPSBwb3NpdGlvblsicG5sIl0KICAgIGZ1bmRpbmcgPSBwb3NpdGlvblsiZnVuZGluZ19yYXRlIl0KICAgIGxldmVyYWdlID0gcG9zaXRpb25bImxldmVyYWdlIl0KICAgIG1hcmtldCA9IHBvc2l0aW9uWyJtYXJrZXQiXQogICAgc2lkZSA9IHBvc2l0aW9uWyJzaWRlIl0KCiAgICBsaXFfZGlzdCA9IGNhbGNfbGlxX2Rpc3RhbmNlX3BjdChtYXJrLCBsaXEpCiAgICBsaXFfZGlzdF9zdHIgPSBmIntsaXFfZGlzdDouMWZ9JSIgaWYgbGlxX2Rpc3QgaXMgbm90IE5vbmUgZWxzZSAiTi9BIgogICAgbGlxX2Vtb2ppID0gIvCflLQiIGlmIChsaXFfZGlzdCBpcyBub3QgTm9uZSBhbmQgbGlxX2Rpc3QgPCBMSVFfV0FSTl9QQ1QpIGVsc2UgIvCfn6IiCgogICAgcG5sX2Vtb2ppID0gIvCfn6IiIGlmIHBubCA+PSAwIGVsc2UgIvCflLQiCiAgICBzaWRlX2Vtb2ppID0gIvCfk4giIGlmIHNpZGUgPT0gIkxPTkciIGVsc2UgIvCfk4kiCgogICAgZnVuZGluZ19zdHIgPSBmIntmdW5kaW5nOi40Zn0lIiBpZiBmdW5kaW5nIGVsc2UgIk4vQSIKICAgIGZ1bmRpbmdfZW1vamkgPSAi4pqg77iPIiBpZiAoZnVuZGluZyBhbmQgYWJzKGZ1bmRpbmcpID4gRlVORElOR19XQVJOX1BDVCkgZWxzZSAi8J+SpCIKCiAgICBsZXZfc3RyID0gZiJ7bGV2ZXJhZ2U6LjFmfXgiIGlmIGxldmVyYWdlIGVsc2UgIk4vQSIKCiAgICByZXR1cm4gIlxuIi5qb2luKFsKICAgICAgICBmIjxiPvCfk4ogW0xFVl06IFNPTCBQT1NJVElPTjwvYj4iLAogICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntzaWRlX2Vtb2ppfSBNQVJLRVQ6IHttYXJrZXR9IHtzaWRlfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+SsCBNQVJLOiAgIHtfZnAobWFyayl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn46vIEVOVFJZOiAge19mcChlbnRyeSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5OQIExFVkVSQUdFOiB7bGV2X3N0cn08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5K8IFNJWkU6ICAgICAge19mdihzaXplKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfj6YgQ09MTEFURVJBTDp7X2Z2KGNvbGxhdGVyYWwpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3BubF9lbW9qaX0gUG5MOiAgICAgICB7X2Z2KHBubCl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e2xpcV9lbW9qaX0gTElRIFBSSUNFOiB7X2ZwKGxpcSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5OPIExJUSBESVNUOiAge2xpcV9kaXN0X3N0cn08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntmdW5kaW5nX2Vtb2ppfSBGVU5ESU5HOiAgIHtmdW5kaW5nX3N0cn08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5WQIHtub3d9PC9jb2RlPiIsCiAgICBdKQoKCmRlZiBmb3JtYXRfbGV2X3N0YXR1cyhwb3NpdGlvbiwgc29sX3ByaWNlPU5vbmUpOgogICAgIiIiRm9ybWF0IC9sZXYtc3RhdHVzIHF1aWNrIG9uZS1saW5lci4iIiIKICAgIG1hcmsgPSAocG9zaXRpb24gb3Ige30pLmdldCgibWFya19wcmljZSIpIG9yIHNvbF9wcmljZQogICAgcG5sID0gKHBvc2l0aW9uIG9yIHt9KS5nZXQoInBubCIsIDApCiAgICBsaXEgPSAocG9zaXRpb24gb3Ige30pLmdldCgibGlxX3ByaWNlIikKICAgIGxpcV9kaXN0ID0gY2FsY19saXFfZGlzdGFuY2VfcGN0KG1hcmssIGxpcSkKCiAgICBpZiBub3QgcG9zaXRpb246CiAgICAgICAgcmV0dXJuIGYiPGI+8J+TiiBMRVYgU1RBVFVTPC9iPlxuPGNvZGU+4p2MIE5vIG9wZW4gcG9zaXRpb24gfCBTT0wge19mcChzb2xfcHJpY2UpfTwvY29kZT4iCgogICAgcG5sX2Vtb2ppID0gIvCfn6IiIGlmIHBubCA+PSAwIGVsc2UgIvCflLQiCiAgICBsaXFfZW1vamkgPSAi8J+UtCIgaWYgKGxpcV9kaXN0IGlzIG5vdCBOb25lIGFuZCBsaXFfZGlzdCA8IExJUV9XQVJOX1BDVCkgZWxzZSAi8J+foiIKICAgIGxpcV9zdHIgPSBmIntsaXFfZGlzdDouMWZ9JSB0byBsaXEiIGlmIGxpcV9kaXN0IGlzIG5vdCBOb25lIGVsc2UgImxpcSBOL0EiCgogICAgcmV0dXJuICJcbiIuam9pbihbCiAgICAgICAgZiI8Yj7wn5OKIFtMRVZdOiBRVUlDSyBTVEFUVVM8L2I+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5KwIFNPTDoge19mcChtYXJrKX0gIHwgIHtwbmxfZW1vaml9IFBuTDoge19mdihwbmwpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e2xpcV9lbW9qaX0ge2xpcV9zdHJ9ICB8ICBFbnRyeToge19mcChwb3NpdGlvblsnZW50cnlfcHJpY2UnXSl9PC9jb2RlPiIsCiAgICBdKQoKCmRlZiBmb3JtYXRfd2hhdF9pZihwb3NpdGlvbiwgdGFyZ2V0cz1Ob25lKToKICAgICIiIkZvcm1hdCAvd2hhdC1pZiBjYWxjdWxhdG9yIGZvciBtdWx0aXBsZSBwcmljZSB0YXJnZXRzLiIiIgogICAgaWYgbm90IHBvc2l0aW9uOgogICAgICAgIHJldHVybiAiPGI+8J+TiiBXSEFULUlGPC9iPlxuPGNvZGU+4p2MIE5vIG9wZW4gcG9zaXRpb24gdG8gY2FsY3VsYXRlLjwvY29kZT4iCgogICAgdGFyZ2V0cyA9IHRhcmdldHMgb3IgUFJJQ0VfVEFSR0VUUwogICAgbGluZXMgPSBbCiAgICAgICAgZiI8Yj7wn5SuIFtMRVZdOiBXSEFULUlGIENBTENVTEFUT1I8L2I+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn46vIEVOVFJZOiB7X2ZwKHBvc2l0aW9uWydlbnRyeV9wcmljZSddKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkrwgU0laRTogIHtfZnYocG9zaXRpb25bJ3NpemVfdXNkJ10pfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgIF0KCiAgICBmb3IgdCBpbiBzb3J0ZWQodGFyZ2V0cyk6CiAgICAgICAgdyA9IGNhbGNfd2hhdF9pZihwb3NpdGlvbiwgdCkKICAgICAgICBpZiBub3QgdzoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBwbmxfZW1vamkgPSAi8J+foiIgaWYgd1sicG5sIl0gPj0gMCBlbHNlICLwn5S0IgogICAgICAgIGxpcV9zdHIgPSBmInt3WydsaXFfZGlzdGFuY2VfcGN0J106LjFmfSUgdG8gbGlxIiBpZiB3WyJsaXFfZGlzdGFuY2VfcGN0Il0gaXMgbm90IE5vbmUgZWxzZSAiTi9BIgogICAgICAgIGxpbmVzLmFwcGVuZCgKICAgICAgICAgICAgZiI8Y29kZT57cG5sX2Vtb2ppfSAke3Q6LjBmfSDihpIgUG5MIHtfZnYod1sncG5sJ10pfSAoe19mcGN0KHdbJ3ByaWNlX2NoYW5nZV9wY3QnXSl9KSB8IHtsaXFfc3RyfTwvY29kZT4iCiAgICAgICAgKQoKICAgIG1vbnRobHkgPSBjYWxjX21vbnRobHlfYWRkX2ltcGFjdChwb3NpdGlvbikKICAgIGlmIG1vbnRobHk6CiAgICAgICAgbGluZXMgKz0gWwogICAgICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGI+8J+StSArJHtNT05USExZX0FERF9VU0Q6LjBmfSBAIHtNT05USExZX0xFVkVSQUdFOi4wZn14IEFERDo8L2I+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5OQIE5ldyBsZXZlcmFnZToge21vbnRobHlbJ25ld19sZXZlcmFnZSddOi4yZn14PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+SvCBOZXcgc2l6ZTogICAgIHtfZnYobW9udGhseVsnbmV3X3RvdGFsX3NpemUnXSl9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+PpiBOZXcgY29sbGF0OiAgIHtfZnYobW9udGhseVsnbmV3X3RvdGFsX2NvbGxhdGVyYWwnXSl9PC9jb2RlPiIsCiAgICAgICAgXQoKICAgIHJldHVybiAiXG4iLmpvaW4obGluZXMpCgoKZGVmIGZvcm1hdF9saXFfYWxlcnQocG9zaXRpb24pOgogICAgIiIiRm9ybWF0IGxpcXVpZGF0aW9uIHJpc2sgYWxlcnQuIiIiCiAgICBtYXJrID0gcG9zaXRpb25bIm1hcmtfcHJpY2UiXQogICAgbGlxID0gcG9zaXRpb25bImxpcV9wcmljZSJdCiAgICBsaXFfZGlzdCA9IGNhbGNfbGlxX2Rpc3RhbmNlX3BjdChtYXJrLCBsaXEpCiAgICByZXR1cm4gIlxuIi5qb2luKFsKICAgICAgICBmIjxiPvCfmqggW0xFVl06IExJUVVJREFUSU9OIFdBUk5JTkc8L2I+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7imqDvuI8gIE9ubHkge2xpcV9kaXN0Oi4xZn0lIGZyb20gbGlxdWlkYXRpb24hPC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5KwIE1BUks6ICAgICAge19mcChtYXJrKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkoAgTElRIFBSSUNFOiB7X2ZwKGxpcSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5OdIENvbnNpZGVyIGFkZGluZyBjb2xsYXRlcmFsIG9yIHJlZHVjaW5nIHNpemUuPC9jb2RlPiIsCiAgICBdKQoKCmRlZiBmb3JtYXRfdGFyZ2V0X2FsZXJ0KHBvc2l0aW9uLCB0YXJnZXQpOgogICAgIiIiRm9ybWF0IHByaWNlIHRhcmdldCBoaXQgYWxlcnQuIiIiCiAgICBtYXJrID0gcG9zaXRpb25bIm1hcmtfcHJpY2UiXQogICAgcG5sID0gcG9zaXRpb25bInBubCJdCiAgICBwbmxfZW1vamkgPSAi8J+foiIgaWYgcG5sID49IDAgZWxzZSAi8J+UtCIKICAgIHJldHVybiAiXG4iLmpvaW4oWwogICAgICAgIGYiPGI+8J+OryBbTEVWXTogVEFSR0VUIEhJVCDigJQgJHt0YXJnZXQ6LjBmfTwvYj4iLAogICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkrAgU09MIFBSSUNFOiB7X2ZwKG1hcmspfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+e3BubF9lbW9qaX0gQ1VSUkVOVCBQbkw6IHtfZnYocG5sKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfjq8gVEFSR0VUOiAke3RhcmdldDouMGZ9IOKchTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+TnSBDb25zaWRlciB0YWtpbmcgcGFydGlhbCBwcm9maXRzLjwvY29kZT4iLAogICAgXSkKCgpkZWYgZm9ybWF0X2Z1bmRpbmdfYWxlcnQocG9zaXRpb24pOgogICAgIiIiRm9ybWF0IGhpZ2ggZnVuZGluZyByYXRlIGFsZXJ0LiIiIgogICAgcmF0ZSA9IHBvc2l0aW9uWyJmdW5kaW5nX3JhdGUiXQogICAgcmV0dXJuICJcbiIuam9pbihbCiAgICAgICAgZiI8Yj7imqDvuI8gW0xFVl06IEhJR0ggRlVORElORyBSQVRFPC9iPiIsCiAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+TiCBGVU5ESU5HOiB7cmF0ZTouNGZ9JSAodGhyZXNob2xkOiB7RlVORElOR19XQVJOX1BDVH0lKTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+SsCBNQVJLOiB7X2ZwKHBvc2l0aW9uWydtYXJrX3ByaWNlJ10pfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+TnSBIaWdoIGZ1bmRpbmcgaXMgY29zdGluZyB5b3UuIE1vbml0b3IgY2xvc2VseS48L2NvZGU+IiwKICAgIF0pCgoKZGVmIGZvcm1hdF9tb250aGx5X3JlbWluZGVyKHBvc2l0aW9uKToKICAgICIiIkZvcm1hdCBtb250aGx5ICQyNTAgYWRkIHJlbWluZGVyLiIiIgogICAgbW9udGhseSA9IGNhbGNfbW9udGhseV9hZGRfaW1wYWN0KHBvc2l0aW9uKSBpZiBwb3NpdGlvbiBlbHNlIE5vbmUKICAgIGxpbmVzID0gWwogICAgICAgIGYiPGI+8J+ThSBbTEVWXTogTU9OVEhMWSBBREQgUkVNSU5ERVI8L2I+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5K1IFRpbWUgdG8gYWRkICR7TU9OVEhMWV9BRERfVVNEOi4wZn0gQCB7TU9OVEhMWV9MRVZFUkFHRTouMGZ9eCBsZXZlcmFnZTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+UlyBodHRwczovL2p1cC5hZy9wZXJwczwvY29kZT4iLAogICAgXQogICAgaWYgbW9udGhseToKICAgICAgICBsaW5lcyArPSBbCiAgICAgICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5OQIEFmdGVyIGFkZCDigJQgbmV3IGxldmVyYWdlOiB7bW9udGhseVsnbmV3X2xldmVyYWdlJ106LjJmfXg8L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5K8IE5ldyBzaXplOiAgICAge19mdihtb250aGx5WyduZXdfdG90YWxfc2l6ZSddKX08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn4+mIE5ldyBjb2xsYXQ6ICAge19mdihtb250aGx5WyduZXdfdG90YWxfY29sbGF0ZXJhbCddKX08L2NvZGU+IiwKICAgICAgICBdCiAgICByZXR1cm4gIlxuIi5qb2luKGxpbmVzKQoKCmRlZiBmb3JtYXRfbGV2ZXJhZ2VfcmVjKHJlYyk6CiAgICAiIiJGb3JtYXQgL2xldnJlYyBsZXZlcmFnZSByZWNvbW1lbmRhdGlvbiBtZXNzYWdlLiIiIgogICAgaWYgbm90IHJlYzoKICAgICAgICByZXR1cm4gIjxiPvCfk4ogTEVWIFJFQzwvYj5cbjxjb2RlPuKdjCBDb3VsZCBub3QgZmV0Y2ggcG9zaXRpb24gb3IgcHJpY2UgZGF0YS48L2NvZGU+IgoKICAgIHNvbF9wcmljZSA9IHJlY1sic29sX3ByaWNlIl0KICAgIGFkZF91c2QgPSByZWNbImFkZF91c2QiXQogICAgdm9sID0gcmVjWyJ2b2wiXQogICAgZnVuZGluZyA9IHJlY1siZnVuZGluZyJdCiAgICB2b2xfYWRqID0gcmVjWyJ2b2xfYWRqdXN0bWVudCJdCiAgICB3b3JzdF9wcmljZSA9IHJlY1sid29yc3RfY2FzZV9wcmljZSJdCiAgICB3b3JzdF9kaXN0ID0gcmVjWyJ3b3JzdF9jYXNlX2xpcV9kaXN0Il0KCiAgICAjIFZvbCBkaXNwbGF5CiAgICBpZiB2b2wgaXMgTm9uZToKICAgICAgICB2b2xfc3RyID0gIk4vQSIKICAgICAgICB2b2xfZW1vamkgPSAi4p2TIgogICAgZWxpZiB2b2wgPiBWT0xfV0FSTklOR19USFJFU0hPTEQ6CiAgICAgICAgdm9sX3N0ciA9IGYie3ZvbDouMWZ9JSAoSElHSCDimqDvuI8pIgogICAgICAgIHZvbF9lbW9qaSA9ICLwn5S0IgogICAgZWxpZiB2b2wgPiBWT0xfSElHSF9USFJFU0hPTEQ6CiAgICAgICAgdm9sX3N0ciA9IGYie3ZvbDouMWZ9JSAobW9kZXJhdGUpIgogICAgICAgIHZvbF9lbW9qaSA9ICLwn5+hIgogICAgZWxzZToKICAgICAgICB2b2xfc3RyID0gZiJ7dm9sOi4xZn0lIChsb3cpIgogICAgICAgIHZvbF9lbW9qaSA9ICLwn5+iIgoKICAgIGZ1bmRpbmdfc3RyID0gZiJ7ZnVuZGluZzorLjRmfSUiIGlmIGZ1bmRpbmcgZWxzZSAiTi9BIgogICAgZnVuZGluZ19lbW9qaSA9ICLinIUiIGlmIGZ1bmRpbmcgYW5kIGZ1bmRpbmcgPj0gMCBlbHNlICgi4pqg77iPIiBpZiBmdW5kaW5nIGFuZCBhYnMoZnVuZGluZykgPiBGVU5ESU5HX0hJR0hfUENUIGVsc2UgIvCfkqQiKQoKICAgIGxpbmVzID0gWwogICAgICAgIGYiPGI+8J+TiiBbTEVWXTogTEVWRVJBR0UgUkVDT01NRU5EQVRJT048L2I+IiwKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT7wn5KwIFNPTCBQUklDRToge19mcChzb2xfcHJpY2UpfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+8J+StSBZT1VSIEFERDogICR7YWRkX3VzZDouMGZ9PC9jb2RlPiIsCiAgICBdCgogICAgaWYgdm9sX2FkaiA8IDA6CiAgICAgICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+4pqg77iPICBIaWdoIHZvbCDigJQgbGV2ZXJhZ2UgcmVkdWNlZCBieSB7YWJzKHZvbF9hZGopOi4xZn14PC9jb2RlPiIpCgogICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+e1NFUH08L2NvZGU+IikKCiAgICBmb3IgciBpbiByZWNbInJlc3VsdHMiXToKICAgICAgICBpZiByWyJibG9ja2VkIl06CiAgICAgICAgICAgIGxpbmVzICs9IFsKICAgICAgICAgICAgICAgIGYiPGI+e3JbJ2xhYmVsJ119PC9iPiIsCiAgICAgICAgICAgICAgICBmIjxjb2RlPvCfmqsgQkxPQ0tFRCDigJQgbGlxIHRvbyBjbG9zZSAoe3JbJ2xpcV9kaXN0YW5jZV9wY3QnXTouMWZ9JSA8IHtEQU5HRVJfTElRX0RJU1RBTkNFOi4wZn0lKTwvY29kZT4iLAogICAgICAgICAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgICAgICBdCiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGxpcV9zdHIgPSBmIntfZnAoclsnbmV3X2xpcV9wcmljZSddKX0iIGlmIHJbIm5ld19saXFfcHJpY2UiXSBlbHNlICJOL0EiCiAgICAgICAgZGlzdF9zdHIgPSBmIntyWydsaXFfZGlzdGFuY2VfcGN0J106LjFmfSUiIGlmIHJbImxpcV9kaXN0YW5jZV9wY3QiXSBpcyBub3QgTm9uZSBlbHNlICJOL0EiCiAgICAgICAgZnVuZGluZ19jb3N0X3N0ciA9IGYifiR7clsnZGFpbHlfZnVuZGluZ19jb3N0J106LjJmfS9kYXkiIGlmIHJbImRhaWx5X2Z1bmRpbmdfY29zdCJdIGVsc2UgIk4vQSIKICAgICAgICBlZmZfbGV2X3N0ciA9IGYie3JbJ2VmZmVjdGl2ZV9sZXZlcmFnZSddOi4yZn14IiBpZiByWyJlZmZlY3RpdmVfbGV2ZXJhZ2UiXSBlbHNlIGYie3JbJ2xldmVyYWdlJ106LjFmfXgiCgogICAgICAgIGxpbmVzICs9IFsKICAgICAgICAgICAgZiI8Yj57clsnbGFiZWwnXX08L2I+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5OQIExldmVyYWdlOiAgICB7clsnbGV2ZXJhZ2UnXTouMWZ9eCAoZWZmLiB7ZWZmX2xldl9zdHJ9KTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfkrwgTmV3IHBvc2l0aW9uOiB7X2Z2KHJbJ25ld190b3RhbF9zaXplJ10pfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfkoAgRXN0LiBsaXE6ICAgICB7bGlxX3N0cn08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn5OPIExpcSBkaXN0YW5jZToge2Rpc3Rfc3RyfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPvCfkrggRnVuZGluZyBjb3N0OiB7ZnVuZGluZ19jb3N0X3N0cn08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7imqDvuI8gIFJpc2s6IHtyWydyaXNrJ119PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+4pyFIEJlc3QgZm9yOiB7clsnYmVzdF9mb3InXX08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgIF0KCiAgICAjIFJlY29tbWVuZGVkCiAgICByZWNfb3B0ID0gcmVjWyJyZWNvbW1lbmRlZCJdCiAgICBpZiByZWNfb3B0OgogICAgICAgIGxpbmVzLmFwcGVuZChmIjxiPuKchSBSRUNPTU1FTkRBVElPTjoge3JlY19vcHRbJ2xldmVyYWdlJ106LjFmfXggKHtyZWNfb3B0WydrZXknXS51cHBlcigpfSk8L2I+IikKICAgIGVsc2U6CiAgICAgICAgbGluZXMuYXBwZW5kKGYiPGI+8J+aqyBBTEwgT1BUSU9OUyBCTE9DS0VEIOKAlCBtYXJrZXQgdG9vIHJpc2t5IHRvIGFkZCBub3c8L2I+IikKCiAgICAjIENvbnRleHQKICAgIGxpbmVzICs9IFsKICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT57dm9sX2Vtb2ppfSBTT0wgVk9MICgzMGQpOiB7dm9sX3N0cn08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPntmdW5kaW5nX2Vtb2ppfSBGVU5ESU5HIFJBVEU6IHtmdW5kaW5nX3N0cn0gKGdvb2QgZm9yIGxvbmdzKTwvY29kZT4iLAogICAgXQoKICAgICMgV29yc3QtY2FzZSB3YXJuaW5nCiAgICBpZiB3b3JzdF9kaXN0IGlzIG5vdCBOb25lIGFuZCB3b3JzdF9kaXN0IDwgV0FSTl9MSVFfRElTVEFOQ0U6CiAgICAgICAgbGluZXMgKz0gWwogICAgICAgICAgICBmIjxjb2RlPntTRVB9PC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+8J+aqCBXT1JTVC1DQVNFOiBTT0wgYXQge19mcCh3b3JzdF9wcmljZSl9ICgtMjAlKTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPiAgIOKGkiBPbmx5IHt3b3JzdF9kaXN0Oi4xZn0lIGZyb20gbGlxIOKAlCBISUdIIERBTkdFUjwvY29kZT4iLAogICAgICAgIF0KICAgIGVsaWYgd29yc3RfZGlzdCBpcyBub3QgTm9uZToKICAgICAgICBsaW5lcyArPSBbCiAgICAgICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgICAgICAgICAgZiI8Y29kZT7wn6evIFdPUlNULUNBU0U6IFNPTCBhdCB7X2ZwKHdvcnN0X3ByaWNlKX0gKC0yMCUpPC9jb2RlPiIsCiAgICAgICAgICAgIGYiPGNvZGU+ICAg4oaSIHt3b3JzdF9kaXN0Oi4xZn0lIGZyb20gbGlxIOKAlCBtYW5hZ2VhYmxlPC9jb2RlPiIsCiAgICAgICAgXQoKICAgIHJldHVybiAiXG4iLmpvaW4obGluZXMpCgoKZGVmIGZvcm1hdF9wcmljZV96b25lcyhweik6CiAgICAiIiJGb3JtYXQgL3ByaWNlem9uZXMgb3V0cHV0LiIiIgogICAgaWYgbm90IHB6OgogICAgICAgIHJldHVybiAiPGI+8J+TjSBQUklDRSBaT05FUzwvYj5cbjxjb2RlPuKdjCBObyBwb3NpdGlvbiBkYXRhIGF2YWlsYWJsZS48L2NvZGU+IgoKICAgIHNvbF9wcmljZSA9IHB6WyJzb2xfcHJpY2UiXQogICAgZW50cnkgPSBwelsiZW50cnkiXQogICAgbGlxID0gcHpbImN1cnJlbnRfbGlxIl0KICAgIGxldmVyYWdlID0gcHpbImxldmVyYWdlIl0KCiAgICBsaW5lcyA9IFsKICAgICAgICBmIjxiPvCfk40gW0xFVl06IFNPTCBQUklDRSBaT05FUzwvYj4iLAogICAgICAgIGYiPGNvZGU+e1NFUH08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfk5AgUG9zaXRpb246IHtsZXZlcmFnZTouMmZ9eCBhdCB7X2ZwKGVudHJ5KX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkrAgQ3VycmVudDogIHtfZnAoc29sX3ByaWNlKX08L2NvZGU+IiwKICAgICAgICBmIjxjb2RlPvCfkoAgTGlxIHByaWNlOiB7X2ZwKGxpcSl9PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgICAgIGYiPGNvZGU+SWYgU09MIGdvZXMgdG86PC9jb2RlPiIsCiAgICAgICAgZiI8Y29kZT57U0VQfTwvY29kZT4iLAogICAgXQoKICAgIGZvciB6IGluIHB6WyJ6b25lcyJdOgogICAgICAgIHBubF9zdHIgPSBfZnYoelsicG5sIl0pCiAgICAgICAgZGlzdF9zdHIgPSBmInt6WydsaXFfZGlzdCddOi4xZn0lIHRvIGxpcSIgaWYgelsibGlxX2Rpc3QiXSBpcyBub3QgTm9uZSBlbHNlICJOL0EiCiAgICAgICAgbGluZXMgKz0gWwogICAgICAgICAgICBmIjxiPnt6WydzdGF0dXMnXX0g4oCUIHtfZnAoelsncHJpY2UnXSl9PC9iPiIsCiAgICAgICAgICAgIGYiPGNvZGU+ICBQbkw6IHtwbmxfc3RyfSAgfCAge2Rpc3Rfc3RyfTwvY29kZT4iLAogICAgICAgICAgICBmIjxjb2RlPiAg4oaSIHt6WydhY3Rpb24nXX08L2NvZGU+IiwKICAgICAgICBdCgogICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+e1NFUH08L2NvZGU+IikKICAgIGxpbmVzLmFwcGVuZChmIjxjb2RlPlNhZmUgcHJpY2UgZmxvb3JzIChhZnRlciArJHtNT05USExZX0FERF9VU0Q6LjBmfSBhZGQpOjwvY29kZT4iKQogICAgZm9yIGxldl9sYWJlbCwgZmxvb3IgaW4gcHpbImZsb29ycyJdLml0ZW1zKCk6CiAgICAgICAgZmxvb3Jfc3RyID0gX2ZwKGZsb29yKSBpZiBmbG9vciBlbHNlICJOL0EiCiAgICAgICAgbGluZXMuYXBwZW5kKGYiPGNvZGU+ICBAIHtsZXZfbGFiZWx9IGxldmVyYWdlIOKGkiBsaXEge2Zsb29yX3N0cn08L2NvZGU+IikKCiAgICByZXR1cm4gIlxuIi5qb2luKGxpbmVzKQoKCiMg4pSA4pSAIEFsZXJ0IGNoZWNrZXIgKGNhbGxlZCBieSBzY2hlZHVsZXIpIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgAoKZGVmIGNoZWNrX2FsZXJ0cyhwb3NpdGlvbik6CiAgICAiIiIKICAgIENoZWNrIGFsbCBhbGVydCBjb25kaXRpb25zLiBSZXR1cm5zIGxpc3Qgb2YgKGFsZXJ0X3R5cGUsIG1lc3NhZ2UpIHR1cGxlcy4KICAgIE9ubHkgZmlyZXMgZWFjaCBhbGVydCBvbmNlIHBlciBjb29sZG93biBwZXJpb2QuCiAgICAiIiIKICAgIGFsZXJ0cyA9IFtdCiAgICBpZiBub3QgcG9zaXRpb246CiAgICAgICAgcmV0dXJuIGFsZXJ0cwoKICAgIG5vdyA9IHRpbWUudGltZSgpCiAgICBtYXJrID0gcG9zaXRpb25bIm1hcmtfcHJpY2UiXQogICAgbGlxID0gcG9zaXRpb25bImxpcV9wcmljZSJdCiAgICBmdW5kaW5nID0gcG9zaXRpb25bImZ1bmRpbmdfcmF0ZSJdCgogICAgIyBMaXF1aWRhdGlvbiByaXNrIGFsZXJ0IChjb29sZG93biAxaCkKICAgIGxpcV9kaXN0ID0gY2FsY19saXFfZGlzdGFuY2VfcGN0KG1hcmssIGxpcSkKICAgIGlmIGxpcV9kaXN0IGlzIG5vdCBOb25lIGFuZCBsaXFfZGlzdCA8IExJUV9XQVJOX1BDVDoKICAgICAgICBpZiBub3cgLSBfc3RhdGVbImxhc3RfbGlxX2FsZXJ0X3RzIl0gPiAzNjAwOgogICAgICAgICAgICBfc3RhdGVbImxhc3RfbGlxX2FsZXJ0X3RzIl0gPSBub3cKICAgICAgICAgICAgYWxlcnRzLmFwcGVuZCgoImxpcSIsIGZvcm1hdF9saXFfYWxlcnQocG9zaXRpb24pKSkKCiAgICAjIFByaWNlIHRhcmdldCBhbGVydHMgKG9uZS10aW1lIHBlciB0YXJnZXQpCiAgICBpZiBtYXJrOgogICAgICAgIGZvciB0YXJnZXQgaW4gUFJJQ0VfVEFSR0VUUzoKICAgICAgICAgICAga2V5ID0gZiJ0YXJnZXRfe3RhcmdldH0iCiAgICAgICAgICAgIGlmIGtleSBub3QgaW4gX3N0YXRlWyJ0YXJnZXRzX2hpdCJdIGFuZCBtYXJrID49IHRhcmdldDoKICAgICAgICAgICAgICAgIF9zdGF0ZVsidGFyZ2V0c19oaXQiXS5hZGQoa2V5KQogICAgICAgICAgICAgICAgYWxlcnRzLmFwcGVuZCgoInRhcmdldCIsIGZvcm1hdF90YXJnZXRfYWxlcnQocG9zaXRpb24sIHRhcmdldCkpKQogICAgICAgICAgICBlbGlmIGtleSBpbiBfc3RhdGVbInRhcmdldHNfaGl0Il0gYW5kIG1hcmsgPCB0YXJnZXQgKiAwLjk3OgogICAgICAgICAgICAgICAgIyBSZXNldCBpZiBwcmljZSBkcm9wcyA+MyUgYmVsb3cgdGFyZ2V0CiAgICAgICAgICAgICAgICBfc3RhdGVbInRhcmdldHNfaGl0Il0uZGlzY2FyZChrZXkpCgogICAgIyBGdW5kaW5nIHJhdGUgYWxlcnQgKGNvb2xkb3duIDRoKQogICAgaWYgZnVuZGluZyBhbmQgYWJzKGZ1bmRpbmcpID4gRlVORElOR19XQVJOX1BDVDoKICAgICAgICBpZiBub3cgLSBfc3RhdGVbImxhc3RfZnVuZGluZ19hbGVydF90cyJdID4gMTQ0MDA6CiAgICAgICAgICAgIF9zdGF0ZVsibGFzdF9mdW5kaW5nX2FsZXJ0X3RzIl0gPSBub3cKICAgICAgICAgICAgYWxlcnRzLmFwcGVuZCgoImZ1bmRpbmciLCBmb3JtYXRfZnVuZGluZ19hbGVydChwb3NpdGlvbikpKQoKICAgIHJldHVybiBhbGVydHMKCgpkZWYgY2hlY2tfbW9udGhseV9yZW1pbmRlcigpOgogICAgIiIiUmV0dXJucyBtb250aGx5IHJlbWluZGVyIG1lc3NhZ2UgaWYgMzAgZGF5cyBoYXZlIHBhc3NlZCwgZWxzZSBOb25lLiIiIgogICAgbm93ID0gdGltZS50aW1lKCkKICAgIGRheXNfZWxhcHNlZCA9IChub3cgLSBfc3RhdGVbImxhc3RfbW9udGhseV9yZW1pbmRlcl90cyJdKSAvIDg2NDAwCiAgICBpZiBkYXlzX2VsYXBzZWQgPj0gTU9OVEhMWV9SRU1JTkRFUl9EQVlTOgogICAgICAgIF9zdGF0ZVsibGFzdF9tb250aGx5X3JlbWluZGVyX3RzIl0gPSBub3cKICAgICAgICByZXR1cm4gVHJ1ZQogICAgcmV0dXJuIEZhbHNlCg=="""

path = "/root/memecoin_engine/jupiter_perps.py"
os.makedirs(os.path.dirname(path), exist_ok=True)
with open(path, "wb") as f:
    f.write(base64.b64decode(CONTENT))
print(f"[OK] Wrote {path}")

# Verify key fields are present
with open(path) as f:
    src = f.read()
for check in ["dataList", "liquidationPrice", "pnlAfterFeesUsd", "borrowFeesUsd", "collateralUsd"]:
    status = "OK" if check in src else "MISSING"
    print(f"  {status}: {check}")
